set timeout 10
set testprefix "testbgpcap "
set aborted 0
set color 1

spawn "./testbgpcap"

# proc simpletest { start } {

simpletest "MP4: MP IP/Uni"
simpletest "MPv6: MP IPv6/Uni"
simpletest "MP2: MP IP/Multicast"
simpletest "MP3: MP IP6/MPLS-labeled VPN"
simpletest "MP5: MP IP6/MPLS-VPN"
simpletest "MP6: MP IP4/MPLS-laveled VPN"
simpletest "MP8: MP unknown AFI/SAFI"
simpletest "MP-short: MP IP4/Unicast, length too short (< minimum)"
simpletest "MP-overflow: MP IP4/Unicast, length too long"
simpletest "caphdr: capability header, and no more"
simpletest "nodata: header, no data but length says there is"
simpletest "padded: valid, with padding"
simpletest "minsize: violates minsize requirement"
simpletest "ORF: ORF, simple, single entry, single tuple"
simpletest "ORF-many: ORF, multi entry/tuple"
simpletest "ORFlo: ORF, multi entry/tuple, hdr length too short"
simpletest "ORFlu: ORF, multi entry/tuple, length too long"
simpletest "ORFnu: ORF, multi entry/tuple, entry number too long"
simpletest "ORFno: ORF, multi entry/tuple, entry number too short"
simpletest "ORFpad: ORF, multi entry/tuple, padded to align"
simpletest "AS4: AS4 capability"
simpletest "GR: GR capability"
simpletest "GR-short: GR capability, but header length too short"
simpletest "GR-long: GR capability, but header length too long"
simpletest "GR-trunc: GR capability, but truncated"
simpletest "GR-empty: GR capability, but empty."
simpletest "MP-empty: MP capability, but empty."
simpletest "ORF-empty: ORF capability, but empty."
simpletest "AS4-empty: AS4 capability, but empty."
simpletest "dyn-empty: Dynamic capability, but empty."
simpletest "dyn-old: Dynamic capability (deprecated version)"
simpletest "Cap-singlets: One capability per Optional-Param"
simpletest "Cap-series: Series of capability, one Optional-Param"
simpletest "AS4more: AS4 capability after other caps (singlets)"
simpletest "AS4series: AS4 capability, in series of capabilities"
simpletest "AS4real: AS4 capability, in series of capabilities"
simpletest "AS4real2: AS4 capability, in series of capabilities"
simpletest "DynCap: Dynamic Capability Message, IP/Multicast"
simpletest "DynCapLong: Dynamic Capability Message, IP/Multicast, truncated"
simpletest "DynCapPadded: Dynamic Capability Message, IP/Multicast, padded"
simpletest "DynCapMPCpadded: Dynamic Capability Message, IP/Multicast, cap data padded"
simpletest "DynCapMPCoverflow: Dynamic Capability Message, IP/Multicast, cap data != length"
