var g_support_html5=0,g_reload_page=1,m=new lang,g_storage=new myStorage,g_modal_url,g_modal_window_width=200,g_modal_window_height=80,timer_idle,g_show_modal=0,g_time_out=9E5,g_time_count=0,g_select_mode=0,g_select_array=null,g_select_folder_count=0,g_select_file_count=0,g_upload_mode=0,g_folder_array=null,g_file_array=null,g_opening_uid="",g_on_rescan_samba=0,g_support_lan=["en-us","zh-tw","zh-cn","cz","pl","ru","de","fr","tr","th","ms","no","fi","da","sv","br","jp","es","it","uk"],g_current_locktoken=
"",g_mouse_x=0,g_mouse_y=0,g_fileview_only=0,g_webdav_client=new davlib.DavClient;g_webdav_client.initialize();g_support_html5=window.File&&window.FileReader&&window.FileList&&window.Blob?1:0;function isListView(){return g_storage.getl("listview")==void 0?1:g_storage.getl("listview")}function isAiModeView(){return g_storage.get("aimode")==void 0?-1:g_storage.get("aimode")}function getAiMode(){return g_storage.get("aimode")==void 0?-1:g_storage.get("aimode")}
function openLoginWindow(a){var b=$("div#modalWindow"),c=b.css("display"),e=function(){var e=$("#table_login input#username").val(),d=$("#table_login input#password").val(),e="Basic "+Base64.encode(e+":"+d);closeJqmWindow(0);doLOGIN(a,e)};g_modal_url="";g_modal_window_width=380;g_modal_window_height=120;if(a=="/")$("#jqmTitleText").text(m.getString("title_login")+" - AiCloud");else{var f=mydecodeURI(a);$("#jqmTitleText").text(m.getString("title_login")+" - "+f.substring(0,35))}c=="block"&&$("#jqmMsgText").text(m.getString("msg_passerror"));
$("#jqmMsg").css("display",c);c="";c+='<table id="table_login" width="100%" height="100%" border="0" align="center" cellpadding="0" cellspacing="0" style="overflow:hidden;table-layout: fixed;">';c+="<tr>";c+="<td>";c+='<form name="form_login">';c+='<fieldset width="120px">';c+="<table>";c+="<tr>";c+='<td><label id="username">'+m.getString("title_username")+'</label></td><td><input name="username" type="text" id="username" autocapitalize="off" maxlength="20" style="width:250px"></td>';c+="</tr>";c+=
"<tr>";c+='<td><label id="password">'+m.getString("title_password")+'</label></td><td><input name="password" type="password" id="password" maxlength="16" style="width:250px"></td>';c+="</tr>";c+="</table>";c+="</fieldset>";c+="</form>";c+="</td>";c+="</tr>";c+='<tr style="height:10px"></tr>';c+="<tr>";c+="<td>";c+='<div class="table_block_footer" style="text-align:right">';c+='<button id="ok" class="btnStyle">'+m.getString("btn_ok")+"</button>";c+='<button id="cancel" class="btnStyle">'+m.getString("btn_cancel")+
"</button>";c+="</div>";c+="</td>";c+="</tr>";c+="</table>";$("#jqmContent").empty();$(c).appendTo($("#jqmContent"));$("#table_login input#password").keydown(function(a){a.keyCode==13&&e()});$("#table_login #ok").click(function(){e()});$("#table_login #cancel").click(function(){closeJqmWindow(0)});b&&b.jqmShow()}
function doRescanSamba(){var a=addPathSlash(g_storage.get("openurl"));closeJqmWindow(0);showHideLoadStatus(!0);g_webdav_client.RESCANSMBPC(a,function(a){a[0]==2&&(a=g_storage.getl("rescan_samba_timer"),a!=0&&clearInterval(a),g_storage.setl("onRescanSamba",1),g_storage.setl("onRescanSambaCount",0),g_storage.setl("rescan_samba_timer",0),g_storage.set("HostList",""),doPROPFIND("/"))})}
function doMKDIR(a){var b=addPathSlash(g_storage.get("openurl")),c=b+myencodeURI(a),e=0;$(".wcb").each(function(){$(this).attr("isdir")=="1"&&a==$(this).attr("data-name")&&(e=1,alert(m.getString("folder_already_exist_msg")))});e!=1&&g_webdav_client.MKCOL(c,function(a){a[0]==2?(doPROPFIND(b),closeJqmWindow(0)):alert(m.getString(a))})}
function doRENAME(a,b){var c=0,e=addPathSlash(g_storage.get("openurl")),f=e+b;$(".wcb").each(function(){b==myencodeURI($(this).attr("data-name"))&&(c=1,$(this).attr("isdir")=="1"?alert(m.getString("folder_already_exist_msg")):alert(m.getString("file_already_exist_msg")))});c!=1&&g_webdav_client.LOCK(a,"",function(b,d,c){if(b!="201")alert(m.getString("msg_already_lock"));else{var h=getLockToken(c);g_webdav_client.MOVE(a,f,function(d){d[0]==2?(doPROPFIND(e),closeJqmWindow(0)):alert(m.getString(d));
g_webdav_client.UNLOCK(a,h,function(a){a!=204&&alert("Unlock error: "+a)})},null,"F",h)}},null)}function getFileViewHeight(){return $("#fileview").height()-20}function closeJqmWindow(a){g_reload_page=a;a=$("div#modalWindow");$("iframe",a).attr("src","");a&&a.jqmHide();showHideLoadStatus(!1)}function resizeJqmWindow(a,b){var c=$(".jqmWindow");c&&(c.css("width",a+"px"),c.css("height",b+"px"))}
function fullscreenJqmWindow(){var a=$("div#modalWindow");a&&(a.css("left","0px"),a.css("top","0px"),a.css("width",window.width+"px"),a.css("height",window.height+"px"))}function doLOGOUT(){doPROPFIND("/",function(){addPathSlash(g_storage.get("openurl"));g_webdav_client.LOGOUT("/",function(a){a[0]==2&&(g_storage.set("openhostuid","0"),window.location.reload())})},0)}
function resetTimer(){clearInterval(timer_idle);g_time_count=0;timer_idle=setInterval(function(){g_storage.get("stopLogoutTimer")=="1"||g_show_modal==1?g_time_count=0:(g_time_count++,g_time_count*1E3>g_time_out&&(g_time_count=0,doLOGOUT()))},1E3)}
function doPROPFINDMEDIALIST(a,b,c,e,f,j,d,g,h,k){if(g_webdav_client!=null){showHideLoadStatus(!0);showHideEditUIRegion(!1);try{g_webdav_client.PROPFINDMEDIALIST(a,function(f,j,l){if(f){if(f==207){showHideSelectModeUI(!1);closeUploadPanel();var k=content2XMLDOM(l),l=1,o=f=0,j="Idle";b||(g_folder_array=null,g_folder_array=[],g_file_array=null,g_file_array=[]);k&&(l=1,f=parseInt(k.documentElement.getAttribute("qcount")),parseInt(k.documentElement.getAttribute("qstart")),o=parseInt(k.documentElement.getAttribute("qend")),
j=k.documentElement.getAttribute("scan_status"),parserPropfindXML(k,a,b));k="";g_ui_mode.get()==1||g_ui_mode.get()==2||g_ui_mode.get()==3?l=0:g_ui_mode.get()==6?(l=0,k="goto:music_album"):g_ui_mode.get()==7&&(l=0,k="goto:music_artist");var n=g_list_view.get()==1?"listview":"thumbview";create_ui_view(n,$("#main_right_container #fileview"),l,k,g_folder_array,g_file_array,onMouseDownListDIVHandler);f>o&&(o+=1,l=o+50,l>f&&(l=f),o="<div class='nextDiv' start='"+o+"' end='"+l+"'><span>",k=m.getString("title_next_query"),
k=k.replace("%s",l),k=k.replace("%s",f),o+=k,o+="</span></div>",$("#main_right_container #fileview").append(o),$(".nextDiv").click(function(){doPROPFINDMEDIALIST(a,!0,null,e,$(this).attr("start"),$(this).attr("end"),d,g,h)}));j=="Scanning"?($("#main_right_container #hintbar").text(m.getString("msg_dms_scanning")),$("#main_right_container #hintbar").show()):$("#main_right_container #hintbar").hide();g_storage.set("aimode",e);$("div#btnUpload").css("display","none");$("div#btnNewDir").css("display",
"none");$("div#btnPlayImage").css("display",e==1?"block":"none");$("div#boxSearch").css("display","block");g_storage.set("openurl",a);$("div#hostview").scrollTop(g_storage.get("hostviewscrollTop"));$("div#fileview").scrollLeft(g_storage.get("contentscrollLeft"));$("div#fileview").scrollTop(g_storage.get("contentscrollTop"));$("div#boxSearch").attr("uhref",a);$("div#boxSearch").attr("qtype",e);adjustLayout();closeJqmWindow(0);c!=void 0&&c()}else f==501?doPROPFINDMEDIALIST(a):f==503?show_hint_no_mediaserver():
f==401?setTimeout(function(){openLoginWindow(a)},2E3):alert(m.getString(f));showHideLoadStatus(!1)}},null,e,f,j,d,g,h,k),resetTimer()}catch(l){alert("catch error: "+l)}}}
function parserPropfindXML(a,b,c){if(a){c==!1&&(g_file_array=g_folder_array=null);g_folder_array==null&&(g_folder_array=[]);g_file_array==null&&(g_file_array=[]);for(var e,f,j,d=a.documentElement.childNodes,a=0;a<d.length;a++){var g="",h="",k="",l="",r="",x="",y="",s="",o="",n="",u="",z="",w="",t;j="";for(var v="0",B="",C="0",D=d[a].childNodes,c=0;c<D.length;c++)if(D[c].nodeType==1&&D[c].nodeName=="D:propstat"){var q=D[c].childNodes;for(e=0;e<q.length;e++)if(q[e].nodeName=="D:prop"){var p=q[e].childNodes;
for(f=0;f<p.length;f++)if(!(p[f].childNodes.length<=0))if(p[f].nodeName=="D:getcontenttype")h=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getuniqueid")k=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getonline")x=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getlastmodified")y=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getcontentlength")s=String(size_format(parseInt(p[f].childNodes[0].nodeValue)));else if(p[f].nodeName=="D:getmac")n=
String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getip")o=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:gettype")u=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getattr"){var E=p[f].childNodes;for(j=0;j<E.length;j++)if(E[j].nodeName=="D:readonly")z=E[j].childNodes[0].nodeValue;else if(E[j].nodeName=="D:hidden")w=E[j].childNodes[0].nodeValue}else if(p[f].nodeName=="D:getuseragent")j=String(p[f].childNodes[0].nodeValue),g_storage.set("user_agent",j);else if(p[f].nodeName==
"D:getroutersync")v=String(p[f].childNodes[0].nodeValue);else if(p[f].nodeName=="D:getmetadata"){E=p[f].childNodes;for(j=0;j<E.length;j++)if(E[j].nodeName=="D:title")B=E[j].childNodes[0].nodeValue;else if(E[j].nodeName=="D:thumb")C=E[j].childNodes[0].nodeValue}}}else D[c].nodeType==1&&D[c].nodeName=="D:href"&&(g=String(D[c].childNodes[0].nodeValue),e="",g.match(/^http/)&&(e=window.location.protocol+"//"+window.location.host),f=e+addPathSlash(b),g!=f?(g=g.replace(e,""),l=g.substring(g.lastIndexOf("/")+
1,g.length),l!=""?(t=l,r=l=mydecodeURI(l)):g=""):g="");g!=""&&(h=="httpd/unix-directory"?g_folder_array.push({contenttype:h,href:g,name:l,uname:t,shortname:r,online:x,time:y,size:s,ip:o,mac:n,uid:k,type:u,freadonly:z,fhidden:w,routersyncfolder:v,matadatatitle:B,thumb:C}):g_file_array.push({contenttype:h,href:g,name:l,uname:t,shortname:r,online:x,time:y,size:s,ip:o,mac:n,uid:k,type:u,freadonly:z,fhidden:w,routersyncfolder:v,matadatatitle:B,thumb:C}))}}}
function content2XMLDOM(a){if(a=="")return null;var b=null,b=null;if(window.DOMParser)b=new DOMParser,b=b.parseFromString(a,"text/xml");else if(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a),!b.documentElement)return alert("Fail to load xml!"),showHideLoadStatus(!1),null;return b}
function doPROPFIND(a,b,c){if(g_webdav_client!=null){showHideLoadStatus(!0);try{g_webdav_client.PROPFIND(a,c,function(e,c,d){if(e){if(e==207){showHideSelectModeUI(!1);closeUploadPanel();var g=content2XMLDOM(d);if(g){e=g.documentElement.getAttribute("qtype");g.documentElement.getAttribute("readonly");c=g.documentElement.getAttribute("ruser");g.documentElement.getAttribute("computername");d=g.documentElement.getAttribute("isusb");parserPropfindXML(g,a,!1);g_folder_array.sort(sortByName);g_file_array.sort(sortByName);
for(g=0;g<g_folder_array.length;g++)g_folder_array[g].type=="usbdisk"&&arraymove(g_folder_array,g,0);g=addPathSlash(a);g!="/"&&(g=g.substring(0,g.length-1),g=g.substring(0,g.lastIndexOf("/")),g==""&&(g="/"));a=="/"&&createHostList(e,g_folder_array);var h=g_list_view.get()==1?"listview":"thumbview";create_ui_view(h,$("#main_right_container #fileview"),e,g,g_folder_array,g_file_array,onMouseDownListDIVHandler);g_thumb_loader.init($("#main_right_container #fileview"));g_thumb_loader.start();showHideAiButton(d==
"1"?!0:!1);closeAiMode();a=="/"?($("div#btnThumbView").css("display","none"),$("div#btnListView").css("display","none")):($("div#btnThumbView").css("display",g_list_view.get()==1?"block":"none"),$("div#btnListView").css("display",g_list_view.get()==1?"none":"block"));$("div#btnUpload").css("display",e==0&&g_select_mode==0?"block":"none");$("div#btnNewDir").css("display",e==0&&g_select_mode==0?"block":"none");$("div#btnPlayImage").css("display",e==0&&g_select_mode==0?"block":"none");$("#btnCancelUpload").css("display",
g_upload_mode==1?"block":"none");$("#btnChangeUser").css("display",e==1&&d==0?"block":"none");$("span#username").text(c);g_storage.set("isAidisk",d);g_storage.set("openurl",a);$("div#hostview").scrollTop(g_storage.get("hostviewscrollTop"));$("div#fileview").scrollLeft(g_storage.get("contentscrollLeft"));$("div#fileview").scrollTop(g_storage.get("contentscrollTop"));$("#main_right_container #hintbar").hide();adjustLayout();closeJqmWindow(0);b!=void 0&&b();if(g_storage.get("openhostuid")==void 0||g_storage.get("openhostuid")==
0)e="<div id='help_1'>",e+="<div id='help_content'>",e+=m.getString("msg_help"),e+="</div>",e+="<div id='help_image'>",e+="</div>",e+="</div>",$("div#fileview").append(e)}}else e==501?doPROPFIND(a):e==401?setTimeout(function(){openLoginWindow(a)},2E3):alert(m.getString(e));showHideLoadStatus(!1)}},null,1),resetTimer()}catch(e){alert("catch error: "+e)}}}
function registerPage(a){if(!(a!="/"||isPrivateIP(g_storage.get("wan_ip"))))a=g_storage.get("ddns_host_name"),a==""?alert("start ddns process"):window.location="http://140.130.25.39/aicloud?v=https://"+a}function doLOGIN(a,b){doPROPFIND(a,function(){g_opening_uid!=""&&(g_storage.set("openhostuid",g_opening_uid),$("#hostview .host_item").each(function(){$(this).attr("uid")==g_opening_uid?$(this).addClass("select"):$(this).removeClass("select")}),g_opening_uid="")},b)}
function refreshHostList(){if(g_webdav_client!=null)try{g_webdav_client.PROPFIND("/",null,function(a,c,e){if(a&&a==207){var f,a=[];if(window.DOMParser)c=new DOMParser,f=c.parseFromString(e,"text/xml");else if(f=new ActiveXObject("Microsoft.XMLDOM"),f.async="false",f.loadXML(e),!f.documentElement){alert("Fail to load xml!");showHideLoadStatus(!1);return}var j,d,g,h,c=f.documentElement.childNodes,e=f.documentElement.getAttribute("qtype");f.documentElement.getAttribute("readonly");f.documentElement.getAttribute("ruser");
f.documentElement.getAttribute("computername");f.documentElement.getAttribute("isusb");for(f=0;f<c.length;f++){var k="",l="",r="",x="",y="",s="",o="",n="",u="",z="",w="",t="",v="",B,C=c[f].childNodes;for(j=0;j<C.length;j++)if(C[j].nodeType==1&&C[j].nodeName=="D:propstat"){var D=C[j].childNodes;for(d=0;d<D.length;d++)if(D[d].nodeName=="D:prop"){var q=D[d].childNodes;for(g=0;g<q.length;g++)if(!(q[g].childNodes.length<=0))if(q[g].nodeName=="D:getcontenttype")l=String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName==
"D:getuniqueid")r=String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName=="D:getonline")s=String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName=="D:getlastmodified")o=String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName=="D:getcontentlength")n=String(size_format(parseInt(q[g].childNodes[0].nodeValue)));else if(q[g].nodeName=="D:getmac")z=String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName=="D:getip")u=String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName=="D:gettype")w=
String(q[g].childNodes[0].nodeValue);else if(q[g].nodeName=="D:getattr"){var p=q[g].childNodes;for(h=0;h<p.length;h++)if(p[h].nodeName=="D:readonly")t=p[h].childNodes[0].nodeValue;else if(p[h].nodeName=="D:hidden")v=p[h].childNodes[0].nodeValue}}}else C[j].nodeType==1&&C[j].nodeName=="D:href"&&(k=String(C[j].childNodes[0].nodeValue),d="",k.match(/^http/)&&(d=window.location.protocol+"//"+window.location.host),g=d+addPathSlash("/"),k!=g?(k=k.replace(d,""),x=k.substring(k.lastIndexOf("/")+1,k.length),
x!=""?(B=x,y=x=mydecodeURI(x),d=g_list_view.get()==0?12:45,y.length>d&&(y=y.substring(0,d)+"...")):k=""):k="");k!=""&&l=="httpd/unix-directory"&&a.push({contenttype:l,href:k,name:x,uname:B,shortname:y,online:s,time:o,size:n,ip:u,mac:z,uid:r,type:w,freadonly:t,fhidden:v})}a.sort(sortByName);for(B=0;B<a.length;B++)a[B].type=="usbdisk"&&arraymove(a,B,0);createHostList(e,a)}},null,1)}catch(a){alert("catch error: "+a)}}
function sortByName(a,b){var c=a.name.toLowerCase(),e=b.name.toLowerCase();return c<e?-1:c>e?1:0}function arraymove(a,b,c){var e=a[b];a.splice(b,1);a.splice(c,0,e)}function onMouseDownThumbDIVHandler(a,b){if(a.button==2)return!1;g_select_mode==1?b.attr("isParent")==1&&(showHideSelectModeUI(!1),openSelItem(b)):openSelItem(b)}function onMouseDownListDIVHandler(a,b){if(a.button==2)return!1;g_select_mode==1?b.attr("isParent")==1&&(showHideSelectModeUI(!1),openSelItem(b)):openSelItem(b)}
function openSelItem(a){var b=a.attr("uhref")==void 0?"":a.attr("uhref"),c=a.attr("qtype")==void 0?0:a.attr("qtype"),e=a.attr("isdir")==void 0?0:a.attr("isdir"),f=a.attr("isusb")==void 0?0:a.attr("isusb"),j=b,d=a.attr("data-name")==void 0?"":a.attr("data-name");g_storage.set("opentype",f);if(b=="goto:music_album")g_webdav_client!=null&&(showHideLoadStatus(!0),b=g_storage.get("openurl")==void 0?"/":g_storage.get("openurl"),g_webdav_client.GETMUSICCLASSIFICATION(b,"album",function(a,e,d){a==200?createClassificationView(d,
"album"):a==503&&show_hint_no_mediaserver();showHideLoadStatus(!1)}));else if(b=="goto:music_artist")g_webdav_client!=null&&(showHideLoadStatus(!0),b=g_storage.get("openurl")==void 0?"/":g_storage.get("openurl"),g_webdav_client.GETMUSICCLASSIFICATION(b,"artist",function(a,e,d){a==200?createClassificationView(d,"artist"):a==503&&show_hint_no_mediaserver();showHideLoadStatus(!1)}));else if(c==2&&a.attr("online")==0)confirm(m.getString("wol_msg"))==!0&&(b=a.attr("mac"),g_webdav_client.WOL("/",b,function(a){a==
200?alert(m.getString("wol_ok_msg")):alert(m.getString("wol_fail_msg"))}));else if(e=="1")doPROPFIND(b,null,null);else{c=getFileExt(b);e=g_storage.get("webdav_mode");if(c=="mp4"||c=="m4v"||c=="wmv"||c=="avi"||c=="rmvb"||c=="rm"||c=="mpg"||c=="mpeg"||c=="mkv"||c=="mov"||c=="flv")if((e==0||e==2)&&isWinOS())if(isBrowser("msie")&&getInternetExplorerVersion()<=7)alert(m.getString("msg_vlcsupport"));else{var g=$("div#modalWindow"),d=myencodeURI(d);this_url=j.substring(0,j.lastIndexOf("/"));var h=window.location.host;
h.indexOf(":")!=-1&&(h=h.substring(0,h.indexOf(":")));var h="http://"+h+":"+g_storage.get("http_port")+"/",k=a.attr("matadatatitle");g_webdav_client.GSL(this_url,this_url,d,0,0,function(a,e,d){a==200&&(a=parseXml(d),a=$(a).find("sharelink").text(),e="",e="/smb/css/vlc_video.html?v="+h+a+"&u="+this_url,e+="&t="+k,e+="&showbutton=1",g_modal_url=e,g_modal_window_width=655,g_modal_window_height=580,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_videoplayer")),g&&g.jqmShow())});
return}if(c=="mp3")openAudioPlayer(b);else{if(c=="doc"||c=="docx"||c=="ppt"||c=="pptx"||c=="xls"||c=="xlsx"||c=="pdf")if((isWinOS()||isMacOS())&&!isPrivateIP()){d=myencodeURI(d);this_url=j.substring(0,j.lastIndexOf("/"));g_webdav_client.GSL(this_url,this_url,d,0,0,function(a,e,d){a==200&&(a=parseXml(d),a=$(a).find("sharelink").text(),e="",a=window.location.protocol+"//"+window.location.host+"/"+a,window.open("https://docs.google.com/viewer?url="+a))});return}c=="jpg"||c=="jpeg"||c=="png"||c=="gif"?
(a=getPageSize(),g_image_player.show(b,a[0],a[1],g_file_array)):window.open(b)}}}
function addtoFavorite(){var a=g_storage.get("ddns_host_name"),b="https://"+a,c=isBrowser("msie");a==""&&(b="https://router.asus.com/");if(typeof window.sidebar=="object"&&typeof window.sidebar.addPanel=="function")return window.sidebar.addPanel("AiCloud",b,""),!1;else if(c&&typeof window.external=="object")return window.external.AddFavorite(b,"AiCloud"),!1;else{window.location=b;var a=navigator.userAgent.toLowerCase(),b="",c=a.indexOf("webkit")!=-1,e=a.indexOf("mac")!=-1;if(a.indexOf("konqueror")!=
-1)b="CTRL + B";else if(window.home||c||e)b=(e?"Command/Cmd":"CTRL")+" + D";b=b?m.getString("msg_add_favorite1")+b+m.getString("msg_add_favorite2"):b;alert(b)}}var IE=document.all?!0:!1;IE||document.captureEvents(Event.MOUSEMOVE);
function getMouseXY(a){IE?(g_mouse_x=event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,g_mouse_y=event.clientY+document.body.scrollTop+document.documentElement.scrollTop):(g_mouse_x=a.pageX,g_mouse_y=a.pageY);g_mouse_x<0&&(g_mouse_x=0);g_mouse_y<0&&(g_mouse_y=0);return!0}
$(document).ready(function(){function a(e){e&&e[0]!=2?alert(m.getString(e)+" : "+decodeURI(g_selected_files[0])):(g_selected_files.splice(0,1),g_selected_files.length<=0?(e=addPathSlash(g_storage.get("openurl")),doPROPFIND(e)):g_webdav_client.DELETE(g_selected_files[0],a))}if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/Android/i)&&navigator.userAgent.match(/Mobile/i)){var b=window.location.href,b=b.substr(b.lastIndexOf("?")+1,b.length);if(b.indexOf("desktop=1")!=
0){b=window.location.href;b=b.substr(0,b.lastIndexOf("?"));window.location=b+"?mobile=1";return}}document.oncontextmenu=function(){return!1};document.onmousedown=function(){resetTimer()};document.onmousemove=function(a){getMouseXY(a);resetTimer()};$(document).keydown(function(a){a.keyCode==27&&(g_select_mode==1?showHideSelectModeUI(!1):g_upload_mode==1&&closeUploadPanel(),closeJqmWindow())});g_storage.set("stopLogoutTimer","0");g_storage.set("isOpenModalWindow","0");g_storage.set("isOnUploadFile",
"0");createLayout();showHideLoadStatus(!1);adjustLayout();(function(){var a=g_storage.get("openurl");g_webdav_client.GETROUTERINFO(a==void 0?"/":a,function(a,e,d){a==200&&(a=parseXml(d),a=$(a),g_storage.set("webdav_mode",a.find("webdav_mode").text()),g_storage.set("http_port",a.find("http_port").text()),g_storage.set("https_port",a.find("https_port").text()),g_storage.set("http_enable",a.find("http_enable").text()),g_storage.set("misc_http_enable",a.find("misc_http_enable").text()),g_storage.set("misc_http_port",
String(a.find("misc_http_port").text()).replace("\n","")),g_storage.set("misc_https_port",String(a.find("misc_https_port").text()).replace("\n","")),g_storage.set("last_login_info",a.find("last_login_info").text()),g_storage.set("ddns_host_name",a.find("ddns_host_name").text()),g_storage.set("router_version",a.find("version").text()),g_storage.set("aicloud_version",a.find("aicloud_version").text()),g_storage.set("smartsync_version",a.find("smartsync_version").text()),g_storage.set("wan_ip",a.find("wan_ip").text()),
g_storage.set("modalname",a.find("modalname").text()),g_storage.set("usbdiskname",a.find("usbdiskname").text()),g_storage.set("dms_enable",a.find("dms_enable").text()),g_storage.set("app_installation_url",a.find("app_installation_url").text()),g_storage.set("https_crt_cn",a.find("https_crt_cn").text()),g_storage.set("max_sharelink",a.find("max_sharelink").text()),a=g_storage.get("last_login_info"),a!=""&&a!=void 0&&a!=null&&(a=String(a).split(">"),a=m.getString("title_logininfo")+a[1]+", "+m.getString("title_ip")+
a[2],$("#login_info").text(a)))})})();if(g_fileview_only==0){var c=g_storage.get("openurl");g_storage.set("HostList","");doPROPFIND("/",function(){c!=void 0&&c!="/"&&doPROPFIND(c)},0)}else c=g_storage.get("openurl"),doPROPFIND(c);initAudioPlayer();$("#modalWindow").jqm({overlay:70,modal:!0,target:"#jqmContent",onHide:function(a){var b=$(a.w);a.o.remove();b.fadeOut("200",function(){g_show_modal=0;if(g_reload_page==1){var a=addPathSlash(g_storage.get("openurl"));doPROPFIND(a)}})},onShow:function(a){var a=
$(a.w),b=$("#jqmContent",a);$("#jqmTitle",a);var c=(getPageSize()[0]-g_modal_window_width)/2;g_show_modal=1;navigator.userAgent.toLowerCase();var d=function(){var a=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=null&&(a=parseFloat(RegExp.$1));return a};g_modal_url!=""&&(b.empty(),$("<iframe src='' frameborder='0' width='100%' height='100%'>").appendTo(b),$("iframe",a).attr("src",g_modal_url));isBrowser("msie")&&d()<=8&&(g_modal_window_height+=
25);a.css({width:g_modal_window_width,height:g_modal_window_height,left:c,top:-g_modal_window_height,opacity:0,display:"block"}).jqmShow().animate({width:g_modal_window_width,height:g_modal_window_height,top:0,left:c,marginLeft:0,opacity:1},200,function(){adjustLayout();$(this).css("display","block")})}});$("div#btnDeleteSel").click(function(){if($(this).hasClass("disable"))return!1;if(!(g_select_array.length<=0)&&confirm(m.getString("del_files_msg"))==!0){g_selected_files=null;g_selected_files=[];
for(var e=0;e<g_select_array.length;e++)g_selected_files.push(g_select_array[e].uhref);g_webdav_client.DELETE(g_selected_files[0],a)}});$("div#btnNewDir").click(function(){if($(this).hasClass("disable"))return!1;var a=$("div#modalWindow");g_modal_url="/smb/css/makedir.html";g_modal_window_width=500;g_modal_window_height=80;$("#jqmMsg").css("display","none");$("#jqmTitleText").text(m.getString("title_newdir"));a&&a.jqmShow()});$("div#btnDownload").click(function(){if($(this).hasClass("disable"))return!1;
if(!(g_select_array.length<=0)){for(var a=[],b=0;b<g_select_array.length;b++){var c=g_select_array[b].title,d=g_select_array[b].uhref,g=g_select_array[b].isdir,h=window.location.href,h=d.substring(0,d.lastIndexOf("/")),c=h+"/"+c;g==1?a.push(c):download_file(c)}download_folder(a)}});$("div#btnRename").click(function(){if($(this).hasClass("disable"))return!1;g_select_array.length==1&&open_rename_window(g_select_array[0].title,g_select_array[0].uhref,g_select_array[0].isdir)});$("div#btnLock").click(function(){if($(this).hasClass("disable"))return!1;
g_select_array.length==1&&g_webdav_client.LOCK(g_select_array[0].uhref,"",function(a,b,c){a!="201"?alert("Error unlocking: "+b):(g_current_locktoken=getLockToken(c),alert("locktoken: "+g_current_locktoken))},null,"exclusive","write",0,3)});$("div#btnUnLock").click(function(){if($(this).hasClass("disable"))return!1;g_select_array.length==1&&g_webdav_client.UNLOCK(g_select_array[0].uhref,g_current_locktoken,function(a){alert(a)})});$("div#btnChangeUser").click(function(){if(confirm(m.getString("msg_changeuser_confirm"))==
!0){$("#main_right_container #fileview").empty();var a=g_storage.get("openurl");g_webdav_client.LOGOUT(a,function(b){b==200&&doPROPFIND(a)})}});$("#btnThumbView").click(function(){g_list_view.set(0);$("#btnThumbView").css("display","none");$("#btnListView").css("display","block");var a=g_storage.get("openurl"),a=a==void 0?"/":a,b=isAiModeView();if(b<0)doPROPFIND(a);else{var c=g_storage.get("data-id")==void 0?"":g_storage.get("data-id"),d=myencodeURI($("div#boxSearch input").val());doPROPFINDMEDIALIST(a,
!1,null,b,"0","50",d,"TIMESTAMP","DESC",c)}});$("#btnListView").click(function(){g_list_view.set(1);$("#btnThumbView").css("display","block");$("#btnListView").css("display","none");var a=g_storage.get("openurl"),a=a==void 0?"/":a,b=isAiModeView();if(b<0)doPROPFIND(a);else{var c=g_storage.get("data-id")==void 0?"":g_storage.get("data-id"),d=myencodeURI($("div#boxSearch input").val());doPROPFINDMEDIALIST(a,!1,null,b,"0","50",d,"TIMESTAMP","DESC",c)}});$("#btnUpload2").click(function(){g_upload_mode=
1;$("div#btnNewDir").css("display","none");$("div#btnUpload").css("display","none");$("div#btnPlayImage").css("display","none");$("div#boxSearch").css("display","none");$("#upload_panel").css("display","block");$("#upload_panel").css("left","1999px");$("#upload_panel").animate({left:"0px"},"slow");var a=addPathSlash(g_storage.get("openurl"));$("#upload_panel iframe").attr("src","/smb/css/upload.html?u="+a);$("#function_help").text(m.getString("msg_uploadmode_help"));adjustLayout()});$("#btnCancelUpload").click(closeUploadPanel);
$(".mediaListDiv").mousedown(function(){var a=$(this).attr("qtype"),b=g_storage.get("openurl");g_storage.set("data-id","");$(".mediaListDiv").removeClass("down");$(this).addClass("down");g_ui_mode.set(a);doPROPFINDMEDIALIST(b,!1,function(){},a,"0","50",null,"TIMESTAMP","DESC")});$("div#btnAiMusicPopupMenux").click(function(){var a="<div class='popupmenu' id='popupmenu'>";a+="<div class='menuitem' id='classifyByAlbum'>";a+="<div class='menuitem-content' style='-webkit-user-select: none;'>";a+="<span class='menuitem-icon a-inline-block' style='-webkit-user-select: none;'>&nbsp;</span>";
a+="<span class='menuitem-container a-inline-block' style='-webkit-user-select: none;'>";a+="<span class='menuitem-caption a-inline-block' style='-webkit-user-select: none;'>";a+="<div style='-webkit-user-select: none;'>"+m.getString("title_sort_by_album")+"</div>";a+="</span>";a+="</span>";a+="</div>";a+="</div>";a+="<div class='menuitem' id='classifyByArtist'>";a+="<div class='menuitem-content' style='-webkit-user-select: none;'>";a+="<span class='menuitem-icon a-inline-block' style='-webkit-user-select: none;'>&nbsp;</span>";
a+="<span class='menuitem-container a-inline-block' style='-webkit-user-select: none;'>";a+="<span class='menuitem-caption a-inline-block' style='-webkit-user-select: none;'>";a+="<div style='-webkit-user-select: none;'>"+m.getString("title_sort_by_artist")+"</div>";a+="</span>";a+="</span>";a+="</div>";a+="</div>";a+="</div>";$(a).appendTo("body");$(".popupmenu").css("left",g_mouse_x-$(".popupmenu").width()+"px");$(".popupmenu").css("top",g_mouse_y-$(".popupmenu").height()+"px");$("#classifyByAlbum").click(function(a){if(g_webdav_client!=
null){showHideLoadStatus(!0);var e=g_storage.get("openurl");g_webdav_client.GETMUSICCLASSIFICATION(e==void 0?"/":e,"album",function(a,e,b){a==200?createClassificationView(b,"album"):a==503&&show_hint_no_mediaserver();showHideLoadStatus(!1)});a.preventDefault();return!1}});$("#classifyByArtist").click(function(){if(g_webdav_client!=null){showHideLoadStatus(!0);var a=g_storage.get("openurl");g_webdav_client.GETMUSICCLASSIFICATION(a==void 0?"/":a,"artist",function(a,e,b){a==200?createClassificationView(b,
"artist"):a==503&&show_hint_no_mediaserver();showHideLoadStatus(!1)})}})});$("div#hostview").scroll(function(){g_storage.set("hostviewscrollTop",$(this).scrollTop())});$("div#fileview").scroll(function(){g_storage.set("contentscrollLeft",$(this).scrollLeft());g_storage.set("contentscrollTop",$(this).scrollTop())});$(".navigation#lan dd a").click(function(){if(confirmCancelUploadFile()!=0){var a=$(this).attr("id");g_storage.set("lan",a);window.location.reload()}});$(".navigation#setting dd a").click(function(){var a=
$(this).attr("id");if(a=="logout")confirmCancelUploadFile()!=0&&(a=confirm(m.getString("msg_logout_confirm")),a==!0&&doLOGOUT());else if(a=="mobile"){var b=window.location.href,b=b.substr(0,b.lastIndexOf("?"));window.location=b+"?mobile=1"}else if(a=="favorite")addtoFavorite();else if(a=="config"){var b=g_storage.get("http_enable"),c=g_storage.get("misc_http_enable"),d=g_storage.get("misc_http_port"),g=g_storage.get("misc_https_port"),h=window.location.host,k="http",a=d;c==0&&!isPrivateIP()?alert(m.getString("msg_no_config")):
(b=="0"?(k="http",a=d):b=="1"&&(k="https",a=g),isPrivateIP()?b=k+"://"+h.split(":")[0]:(b=k+"://"+h.split(":")[0],a!=""&&(b+=":"+a)),window.location=b)}else a=="help"?(a=$("div#modalWindow"),b=getPageSize(),g_modal_window_height=b[1]-30,g_modal_window_width=g_modal_window_height*1.28,g_modal_window_width>b[0]&&(g_modal_window_width=b[0],g_modal_window_height=g_modal_window_width*0.78125),g_modal_url="/smb/css/help.html?showbutton=1",$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_help")),
a&&a.jqmShow()):a=="rescan_samba"?confirmCancelUploadFile()!=0&&(a=confirm(m.getString("title_desc_rescan")),a==!0&&doRescanSamba()):a=="sharelink"?(a=$("div#modalWindow"),b=getPageSize(),g_modal_url="/smb/css/setting.html?p=1&s=1",g_modal_window_width=800,g_modal_window_height=b[1]-30,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_setting")),a&&a.jqmShow()):a=="version"?(a=$("div#modalWindow"),b=getPageSize(),g_modal_url="/smb/css/setting.html?p=2&s=1",g_modal_window_width=
800,g_modal_window_height=b[1]-30,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_setting")),a&&a.jqmShow()):a=="crt"?(a=$("div#modalWindow"),b=getPageSize(),g_modal_url="/smb/css/setting.html?p=3&s=1",g_modal_window_width=800,g_modal_window_height=b[1]-30,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_crt")),a&&a.jqmShow()):a=="test_func"?g_webdav_client.GETNOTICE("/","Dec 31 12:00:20",function(a,b,d){a==200&&(a=parseXml(d),a=$(a).find("log").text());
alert(a)}):a=="test_func2"&&g_webdav_client.NVRAMGET("/","rc_support;webdav_last_login_info",function(a,b,d){a==200?(a=parseXml(d),$(a).find("nvram").each(function(){var a=$(this).attr("key"),b=$(this).attr("value");alert("key="+a+", value="+b)})):alert(a)})});$(".navigation#refresh dt a").click(function(){var a=g_storage.get("openurl");g_storage.set("HostList","");doPROPFIND("/",function(){a=a==void 0?"/":a;a!="/"&&doPROPFIND(a)},0)});$(".themes_ctrl").click(function(){if(confirmCancelUploadFile()!=
0){var a=$(this).attr("id");g_storage.setl("skin",a);window.location.reload()}});$("div#btnPlayImage").click(function(){var a=getPageSize();g_image_player.show("",a[0],a[1],g_file_array)});$("div#boxSearch").keyup(function(){var a=myencodeURI($("div#boxSearch input").val()),b=$(this).attr("uhref"),c=$(this).attr("qtype"),d=g_storage.get("data-id")==void 0?"":g_storage.get("data-id");doPROPFINDMEDIALIST(b,!1,function(){},c,"0","50",a,"TIMESTAMP","DESC",d)});$("div#logo").click(function(){g_fileview_only!=
1&&doPROPFIND("/",function(){g_storage.set("openhostuid","");window.location.reload()},0)});$("#button-select-all").click(function(){g_select_array=null;g_select_array=[];g_select_folder_count=g_select_file_count=0;$("#fileview .wcb").each(function(){var a=!1;var b=$(this),a=b.attr("uhref"),c=b.attr("isdir"),b=myencodeURI(b.attr("data-name"));a==void 0?a=!1:(c==1?g_select_folder_count++:g_select_file_count++,g_select_array.push({isdir:c,uhref:a,title:b}),a=!0);a&&($(this).find(".item-check").addClass("x-view-selected"),
$(this).find(".item-check").show(),$(this).css("background-color","#00C2EB"))});refreshSelectWindow()});$("#button-unselect-all").click(function(){g_select_array=null;g_select_folder_count=g_select_file_count=0;$("#fileview .wcb").each(function(){$(this).find(".item-check").removeClass("x-view-selected");$(this).find(".item-check").hide();$(this).find(".item-menu").removeClass("x-view-menu-popup");$(this).find(".item-menu").hide();$(this).css("background-color","")});refreshSelectWindow()});$.contextMenu({selector:"div#btnShareLink",
trigger:"left",callback:function(a){if(a=="upload2facebook"){if(!(g_select_array.length<=0)){for(var b=[],a=0;a<g_select_array.length;a++){var c=g_select_array[a].uhref,d=getFileExt(c);(d=="jpg"||d=="jpeg"||d=="png"||d=="gif")&&b.push(c)}open_upload2service_window("facebook",b)}}else if(a=="upload2flickr"){if(!(g_select_array.length<=0)){b=[];for(a=0;a<g_select_array.length;a++)c=g_select_array[a].uhref,d=getFileExt(c),(d=="jpg"||d=="jpeg"||d=="png"||d=="gif")&&b.push(c);open_upload2service_window("flickr",
b)}}else if(a=="share2facebook"){if(!(g_select_array.length<=0)){b=g_storage.get("openurl");c=[];for(a=0;a<g_select_array.length;a++)d=g_select_array[a].title,c.push(d);open_sharelink_window("facebook",b,c)}}else if(a=="share2googleplus"){if(!(g_select_array.length<=0)){b=g_storage.get("openurl");c=[];for(a=0;a<g_select_array.length;a++)d=g_select_array[a].title,c.push(d);open_sharelink_window("googleplus",b,c)}}else if(a=="share2twitter"){if(!(g_select_array.length<=0)){b=g_storage.get("openurl");
c=[];for(a=0;a<g_select_array.length;a++)d=g_select_array[a].title,c.push(d);open_sharelink_window("twitter",b,c)}}else if(a=="share2plurk"){if(!(g_select_array.length<=0)){b=g_storage.get("openurl");c=[];for(a=0;a<g_select_array.length;a++)d=g_select_array[a].title,c.push(d);open_sharelink_window("plurk",b,c)}}else if(a=="sharelink"&&!(g_select_array.length<=0)){b=g_storage.get("openurl");c=[];for(a=0;a<g_select_array.length;a++)d=g_select_array[a].title,c.push(d);open_sharelink_window("other",b,
c)}},items:{submenu_upload:{name:m.getString("title_upload2"),disabled:function(){if(g_select_array.length<=0)return!0;for(var a=0;a<g_select_array.length;a++){var b=getFileExt(g_select_array[a].uhref);if(b=="jpg"||b=="jpeg"||b=="png"||b=="gif")return!1}return!0},items:{upload2facebook:{name:m.getString("title_facebook")},upload2flickr:{name:m.getString("title_flickr")}}},submenu_share:{name:m.getString("title_share2"),items:{share2facebook:{name:m.getString("title_facebook")},share2googleplus:{name:m.getString("title_googleplus")},
share2twitter:{name:m.getString("title_twitter")},share2plurk:{name:m.getString("title_plurk")}}},sharelink:{name:m.getString("title_gen_sharelink")}}});$.contextMenu({selector:"div#btnUpload",trigger:"left",callback:function(a){a=="uploadfile"?open_uploadfile_window():a=="uploadfolder"&&open_uploadfolder_window()},items:{uploadfile:{name:m.getString("title_upload_file")},uploadfolder:{name:m.getString("title_upload_folder")}}});$.contextMenu({selector:"div#btnAiMusicPopupMenu",trigger:"left",callback:function(a){a==
"sort_by_album"?g_webdav_client!=null&&(showHideLoadStatus(!0),a=g_storage.get("openurl"),g_webdav_client.GETMUSICCLASSIFICATION(a==void 0?"/":a,"album",function(a,b,d){a==200?createClassificationView(d,"album"):a==503&&show_hint_no_mediaserver();showHideLoadStatus(!1)})):a=="sort_by_artist"&&g_webdav_client!=null&&(showHideLoadStatus(!0),a=g_storage.get("openurl"),g_webdav_client.GETMUSICCLASSIFICATION(a==void 0?"/":a,"artist",function(a,b,d){a==200?createClassificationView(d,"artist"):a==503&&show_hint_no_mediaserver();
showHideLoadStatus(!1)}))},items:{sort_by_album:{name:m.getString("title_sort_by_album")},sort_by_artist:{name:m.getString("title_sort_by_artist")}}});$.contextMenu({selector:".item-menu",trigger:"left",events:{show:function(){},hide:function(){$(this).removeClass("x-view-menu-popup")}},callback:function(a){var b=$(this).parents(".wcb"),c=b.attr("uhref"),d=encodeURIComponent(b.attr("data-name")),b=b.attr("isdir");a=="delete"?c!=""&&confirm(m.getString("del_files_msg")+" - "+d)==!0&&g_webdav_client.DELETE(c,
function(){var a=addPathSlash(g_storage.get("openurl"));doPROPFIND(a)}):a=="rename"?open_rename_window(d,c,b):a=="download"?b=="1"?download_folder(c):download_file(c):a=="upload2facebook"?open_upload2service_window("facebook",c):a=="upload2flickr"?open_upload2service_window("flickr",c):a=="share2facebook"?(a=g_storage.get("openurl"),open_sharelink_window("facebook",a,d)):a=="share2googleplus"?(a=g_storage.get("openurl"),open_share2service_window("googleplus",a,d)):a=="share2twitter"?(a=g_storage.get("openurl"),
open_sharelink_window("twitter",a,d)):a=="share2plurk"?(a=g_storage.get("openurl"),open_sharelink_window("plurk",a,d)):a=="sharelink"&&(a=g_storage.get("openurl"),open_sharelink_window("other",a,d))},items:{"delete":{name:m.getString("func_delete"),disabled:function(){if(g_storage.get("aimode")==1||g_storage.get("aimode")==2||g_storage.get("aimode")==3)return!0}},sep1:"---------",rename:{name:m.getString("func_rename"),disabled:function(){if(g_storage.get("aimode")==1||g_storage.get("aimode")==2||
g_storage.get("aimode")==3)return!0}},download:{name:m.getString("func_download")},sep2:"---------",submenu_upload:{name:m.getString("title_upload2"),disabled:function(){if(g_select_array.length<=0)return!0;for(var a=0;a<g_select_array.length;a++){var b=getFileExt(g_select_array[a].uhref);if(b=="jpg"||b=="jpeg"||b=="png"||b=="gif")return!1}return!0},items:{upload2facebook:{name:m.getString("title_facebook")},upload2flickr:{name:m.getString("title_flickr")}}},submenu_share:{name:m.getString("title_share2"),
items:{share2facebook:{name:m.getString("title_facebook")},share2googleplus:{name:m.getString("title_googleplus")},share2twitter:{name:m.getString("title_twitter")},share2plurk:{name:m.getString("title_plurk")}}},sharelink:{name:m.getString("title_gen_sharelink")}}});$(window).resize(adjustLayout)});window.onbeforeunload=function(a){if(g_storage.get("isOnUploadFile")==1){var b=m.getString("msg_confirm_cancel_upload");if(a=a||window.event)a.returnValue=b;return b}};window.onunload=function(){confirmCancelUploadFile()};
function doBackgroundPlay(){alert("doBackgroundPlay")};var g_bshowHideAiButton=!0,g_bshowHideEditUIRegion=!1,g_hide_aidisk_name=1,g_list_view={_storage:new myStorage,set:function(a){this._storage.setl("listview",a)},get:function(){return this._storage.getl("listview")}},g_ui_mode={_storage:new myStorage,set:function(a){this._storage.set("uimode",a)},get:function(){return this._storage.get("uimode")}},g_usbdisk_space_handler={_changed:!1,_usbdisk_query_index:0,_usbdisk_current_query_index:-1,_usbdisk_query_timer:0,_array:[],add:function(a,b){if(!this.exist(a,
b)){var c={};c.id=a;c.name=b;c.done=!1;c.diskUsedPercent="0%";c.diskUsed=0;c.diskAvailable=0;this._array.push(c)}},exist:function(a,b){for(var c=0;c<this.len();c++)if(this.item(c).id==a&&this.item(c).name==b)return!0;return!1},len:function(){return this._array.length},item:function(a){return a<0||a>this._array.length-1?null:this._array[a]},refresh:function(){if(!(this.len()<=0)){var a=function(a){if(a!=null){var b="div."+a.id+" p",f="div."+a.id+" .progress-bar span",j=a.name+" [ "+bytesToSize(a.diskUsed)+
" / "+bytesToSize(a.diskAvailable+a.diskUsed)+" ]";$(b).parents(".host_item").attr("title",j);$(b).text(j);$(f).css("width",a.diskUsedPercent)}},b=this;this._usbdisk_query_index=0;this._usbdisk_current_query_index=-1;this._usbdisk_query_timer=setInterval(function(){if(b._usbdisk_current_query_index!=b._usbdisk_query_index){var c=b.len(),e=b.item(b._usbdisk_query_index);if(e!=null){var f=e.name,j=e.done;b._usbdisk_current_query_index=b._usbdisk_query_index;j?(a(e),b._usbdisk_query_index==c-1?clearInterval(b._usbdisk_query_timer):
b._usbdisk_query_index++):(j=new davlib.DavClient,j.initialize(),j.GETDISKSPACE("/",f,function(d,f,h){d==200?(d=parseXml(h),d=$(d),e.diskUsedPercent=d.find("DiskUsedPercent").text()==""?"0%":d.find("DiskUsedPercent").text(),e.diskUsed=parseInt(d.find("DiskUsed").text()==""?"0":d.find("DiskUsed").text())*1024,e.diskAvailable=parseInt(d.find("DiskAvailable").text()==""?"0":d.find("DiskAvailable").text())*1024,e.done=!0,a(e),b._usbdisk_query_index==c-1?clearInterval(b._usbdisk_query_timer):b._usbdisk_query_index++):
clearInterval(b._usbdisk_query_timer)}),j=null)}}},200)}}};function bytesToSize(a){if(a==0)return"0";var b=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return(a/Math.pow(1024,b)).toFixed(2)+" "+["Bytes","KB","MB","GB","TB"][b]}
function createLayout(){var a=String(window.navigator.userLanguage||window.navigator.language).toLowerCase(),a=g_storage.get("lan")==void 0?a:g_storage.get("lan"),a=m.setLanguage(a);g_storage.set("lan",a);$("body").attr("openurl")!=void 0&&g_storage.set("openurl",$("body").attr("openurl"));$("body").attr("fileview_only")!=void 0&&(g_fileview_only=$("body").attr("fileview_only"));var b="";b+="<div id='header_region' class='unselectable' width='100%' border='0'>";g_fileview_only==0&&(b+="<div id='user'><div id='user_image' class='sicon'></div><span id='username'></span><span id='login_info'></span>",
b+="</div>");b+="<div id='loading'><img src='/smb/css/load.gif'/><div><span>Loading...</span></div></div>";b+="<ul class='navigation' id='lan'>";b+="<li>";b+="<dl>";b+="<dt><a id='"+a+"'>"+m.getString("lan_"+a)+"</a></dt>";for(var c=0;c<g_support_lan.length;c++)g_support_lan[c]!=a&&(b+="<dd><a id='"+g_support_lan[c]+"'>"+m.getString("lan_"+g_support_lan[c])+"</a></dt>");b+="</dl>";b+="</li>";b+="<ul>";b+="</div>";b+="<div id='main_region' class='unselectable'>";b+="<div style='width: 100%;height:100%;float:left;position: relative;'>";
g_fileview_only==0&&(b+="<div id='main_left_region' class='unselectable'>",b+="<div id='infobar' class='unselectable'>",b+="<div id='logo'></div>",b+="<div style='text-align:center;'><img class='production_icon' style='width:auto !important;height:145px;'></div>",b+="</div>",b+="<div id='hostview' class='unselectable'></div>",b+="</div>");b+="<div id='main_right_region' class='unselectable'>";b+="<div id='main_right_container' class='unselectable'>";b+="<div id='infobar' class='unselectable'>";b+=
"<div id='toolbar' class='unselectable'>";b+="<div id='urlregion-url'>";b+="<p id='openurl' align='left' width='150' style='padding-left:10px' ></p>";b+="</div>";b+="<div class='albutton toolbar-button-right' id='btnThumbView' style='display:none'><div class='ticon'></div></div>";b+="<div class='albutton toolbar-button-right' id='btnListView' style='display:none'><div class='ticon'></div></div>";g_fileview_only==0&&(b+="<div class='albutton toolbar-button-right' id='btnUpload' style='display:none'><div class='ticon'></div></div>",
b+="<div class='albutton toolbar-button-right' id='btnPlayImage' style='display:none'><div class='ticon'></div></div>",b+="<div class='albutton toolbar-button-right' id='btnNewDir' style='display:none'><div class='ticon'></div></div>",b+="<div class='albutton toolbar-button-right' id='btnCancelUpload' style='display:none'><div class='ticon'></div></div>",b+="<div class='albutton toolbar-button-right' id='btnChangeUser' style='display:none'><div class='ticon'></div></div>",b+="<div class='alsearch toolbar-button-right' id='boxSearch' style='display:none'><input type='text'/></div>");
b+="</div>";b+="</div>";b+="<div id='hintbar' class='unselectable'></div>";b+="<div id='fileview' class='unselectable context-menu-one'></div>";b+="<div id='upload_panel' class='unselectable'>";b+="<div style='position:absolute;width:98%;height:100%;padding:10px'>";b+="</div>";b+="</div>";b+="<a id='btn_show_upload_panel' class='ui-icon'>";b+="</a>";b+="</div>";b+="</div>";g_fileview_only==0&&(b+="<div id='button_panel' class='unselectable'>",b+="<div id='ui_region'>",b+="<div class='abbutton toolbar-button-left mediaListDiv' id='btnAiMusic' style='display:none' qtype='2'>",
b+="<div class='ticon'><span>"+m.getString("title_audiolist")+"</span></div></div>",b+="<div class='abbutton toolbar-button-left' id='btnAiMusicPopupMenu' style='display:none' qtype='2'>",b+="<div class='picon'></div></div>",b+="<div class='abbutton toolbar-button-left mediaListDiv' id='btnAiMovie' style='display:none' qtype='3'>",b+="<div class='ticon'><span>"+m.getString("title_videolist")+"</span></div></div>",b+="<div class='abbutton toolbar-button-left mediaListDiv' id='btnAiPhoto' style='display:none' qtype='1'>",
b+="<div class='ticon'><span>"+m.getString("title_imagelist")+"</span></div></div>",b+="<div id='edit_ui_region' style='display:none'>",b+="<div class='albutton toolbar-button-right disable' id='btnShareLink' style='display:block'><div class='ticon'></div></div>",b+="<div class='albutton toolbar-button-right disable' id='btnDeleteSel' style='display:block'><div class='ticon'></div></div>",b+="<div class='albutton toolbar-button-right disable' id='btnDownload' style='display:block'><div class='ticon'></div></div>",
b+="<div class='albutton toolbar-button-right disable' id='btnRename' style='display:block'><div class='ticon'></div></div>",b+="</div>",b+="</div>",b+="</div>");b+="</div>";b+="</div>";b+="<div id='bottom_region' class='unselectable'>";g_fileview_only==0&&(b+="<ul class='navigation' id='setting'>",b+="<li>",b+="<dl>",b+="<dd><a id='web_help' href='http://event.asus.com/2012/nw/aicloud/faq.html' target='_blank'>"+m.getString("title_help")+"</a></dt>",b+="<dd><a id='web_feedback' href='https://vip.asus.com/VIP2/Services/QuestionForm/TechQuery' target='_blank'>"+
m.getString("title_feedback")+"</a></dt>",b+="<dd><a id='version'>"+m.getString("title_version")+"</a></dt>",b+="<dd><a id='crt'>"+m.getString("title_crt")+"</a></dt>",b+="<dd><a id='sharelink'>"+m.getString("title_sharelink")+"</a></dt>",b+="<dd><a id='rescan_samba'>"+m.getString("title_rescan")+"</a></dt>",b+="<dd><a id='config'>"+m.getString("btn_config")+"</a></dt>",b+="<dd><a id='favorite'>"+m.getString("btn_favorite")+"</a></dt>",b+="<dd><a id='mobile'>"+m.getString("title_mobile_view")+"</a></dt>",
b+="<dd><a id='logout'>"+m.getString("title_logout")+"</a></dt>",b+="<dt><a>"+m.getString("title_setting")+"</a></dt>",b+="</dl>",b+="</li>",b+="</ul>",b+="<ul class='navigation' id='refresh'>",b+="<li>",b+="<dl>",b+="<dt><a>"+m.getString("btn_refresh")+"</a></dt>",b+="</dl>",b+="</li>",b+="</ul>");b+="<ul class='func_help'>";b+="<span id='function_help'></span>";b+="</ul>";b+="<span id='right_info'>ASUSTeK Computer Inc. All rights reserved</span>";b+="</div>";b+="<div id='modalWindow' class='jqmWindow'>";
b+="<div id='jqmTitle'>";b+="<span id='jqmTitleText'></span>";b+="</div>";b+="<div id='jqmMsg'>";b+="<span id='jqmMsgText'></span>";b+="</div>";b+="<div id='jqmContent' style='padding;0px;margin:0px'>";b+="</div>";b+="</div>";b+="<div id='selectWindow' class='select-window'>";b+="<div class='select-window-panel'>";b+="<table cellspacing='0' class='select-window-toolbar-ct'><tbody><tr>";b+="<td class='select-window-toolbar-left' alight='left' width='100%'>";b+="<table cellspacing='0'><tbody><tr class='toolbar-left-row'><td class='toolbar-cell'>";
b+="<label class='selected-desc-text'></label>";b+="</td></tr></tbody></table>";b+="</td>";b+="<td class='select-window-toolbar-right' alight='right'>";b+="<table cellspacing='0'><tbody><tr class='toolbar-right-row'><td class='toolbar-cell'>";b+="<table cellspacing='0'><tbody><tr>";b+="<td class='toolbar-cell'><button type='button' id='button-select-all' class='x-btn-text'>"+m.getString("btn_select_all")+"</button></td>";b+="<td class='toolbar-cell'></td>";b+="<td class='toolbar-cell'><button type='button' id='button-unselect-all' class='x-btn-text'>"+
m.getString("btn_deselect")+"</button></td>";b+="</tr></tbody></table>";b+="</td></tr></tbody></table>";b+="</td>";b+="</tr></tbody></table>";b+="</div>";b+="</div>";b+=getAudioPlayerLayout();$("body").empty();$("body").append(b);g_webdav_client.GETPRODUCTICON("/",function(a,b,c){a==200?(a=parseXml(c),a=$(a),$("img.production_icon").attr("src","data:"+a.find("mimetype").text()+";base64,"+a.find("product_icon").text())):$("img.production_icon").attr("src","/smb/css/default_router.png")});$("#main_region").mousedown(function(){});
$("span#username").click(function(){confirm(m.getString("msg_logout_confirm"))==!0&&doLOGOUT()});$(".navigation li, .navigation li a").mouseenter(function(){$(this).find("dd").fadeIn("fast")});$(".navigation li, .navigation li a").mouseleave(function(){$(this).find("dd").fadeOut("fast")});$("#mainCss").attr("href","/smb/css/style-theme.css");$("#btnHelp").attr("title",m.getString("title_help"));$("#btnLogout").attr("title",m.getString("title_logout"));$("#btnConfig").attr("title",m.getString("btn_config"));
$("#btnUpload").attr("title",m.getString("btn_upload"));$("#btnCancelUpload").attr("title",m.getString("btn_cancelupload"));$("#btnNewDir").attr("title",m.getString("btn_newdir"));$("#btnShareLink").attr("title",m.getString("btn_sharelink"));$("#btnDeleteSel").attr("title",m.getString("btn_delselect"));$("#btnDownload").attr("title",m.getString("func_download"));$("#btnRename").attr("title",m.getString("btn_rename"));$("#btnSetting").attr("title",m.getString("title_setting"));$("#btnRefresh").attr("title",
m.getString("btn_refresh"))}
function createHostList(a,b){var c="";$("#hostview").empty();var e=g_storage.get("HostList")?g_storage.get("HostList").split(/,/):[],f=g_storage.getl("onRescanSamba"),j=g_storage.getl("onRescanSambaCount"),d=g_storage.getl("rescan_samba_timer");if(a==2)for(var g=0;g<b.length;g++){var h=b[g].href+"|"+b[g].name+"|"+b[g].online+"|"+b[g].ip+"|"+b[g].mac+"|"+b[g].uid+"|"+b[g].freadonly+"|"+b[g].fhidden+"|"+b[g].type;e.contains(h)||e.push(h);g_storage.set("HostList",e.join(","))}for(g=0;g<e.length;g++){h=
e[g].split("|");c+="<div class='host_item unselectable";h[2]==0&&(c+=" offline");h[8]=="usbdisk"&&(c+=" usbdisk");c+="' uhref='";c+=h[0];c+="' title='";c+=h[1]+" - "+h[3];c+="' online='";c+=h[2];c+="' isdir='1'";c+=" ip='";c+=h[3];c+="' mac='";c+=h[4];c+="' uid='";c+=h[5];c+="' freadonly='";c+=h[6];c+="' fhidden='";c+=h[7];c+=h[8]=="usbdisk"?"' isusb='1'":"' isusb='0'";c+=">";c+="<div id='hosticon' class='sicon "+h[8];h[2]==0&&(c+="off");c+="'/>";if(h[8]=="usbdisk"){var k="usbdisk"+(g+10);c+="<div id='hostinfo' class='unselectable "+
k+"'>";g_usbdisk_space_handler.add(k,h[1])}else c+="<div id='hostinfo' class='unselectable'>";c+="<div id='hostname' class='unselectable'>";c+="<p>";c+=h[1];h[2]==0&&(c+="("+m.getString("title_offline")+")");c+="</p>";c+="</div>";h[8]=="usbdisk"&&(c+="<div id='space'>",c+="<div class='progress-bar'>",c+="<span></span>",c+="</div>",c+="</div>");c+="</div>";c+="</div>"}g_usbdisk_space_handler.refresh();f==1&&(c+="<div class='scan_item unselectable rescan'>",c+="<div id='hosticon' class='sicon sambapcrescan'/>",
c+="<div id='scanlabel' class='unselectable'>",c+="<p>"+m.getString("title_scan")+"</p>",c+="</div>",c+="</div>",d==0&&(d=setInterval(function(){j++;j>=10?(clearInterval(d),g_storage.setl("rescan_samba_timer",0),g_storage.setl("onRescanSamba",0),g_storage.setl("onRescanSambaCount",0)):g_storage.setl("onRescanSambaCount",j);refreshHostList()},5E3),g_storage.setl("rescan_samba_timer",d)));$("#hostview").append(c);var l=g_storage.get("openhostuid");$("#hostview .host_item").each(function(){$(this).attr("uid")==
l?$(this).addClass("select"):$(this).removeClass("select")});$("#hostview .host_item").click(function(){if($(this).attr("online")==0)confirm(m.getString("wol_msg"))==!0&&g_webdav_client.WOL("/",$(this).attr("mac"),function(a){a==200?alert(m.getString("wol_ok_msg")):alert(m.getString("wol_fail_msg"))});else{g_opening_uid=$(this).attr("uid");var a=$(this).attr("uhref");g_storage.set("opentype",$(this).attr("type")=="usbdisk"?"1":"0");doPROPFIND(a,function(){g_storage.set("openhostuid",g_opening_uid);
$("#hostview .host_item").each(function(){$(this).attr("uid")==g_opening_uid?$(this).addClass("select"):$(this).removeClass("select")});g_opening_uid=""},null)}})}
function createClassificationView(a,b){var c=parseXml(a);$(c);var e="";$("#main_right_container #fileview").empty();$(c).find("item").each(function(){var a=$(this).find("id").text(),c=$(this).find("title").text(),d=$(this).find("artist").text(),g=$(this).find("thumb_image").text();e+='<div class="card" data-id="'+a+'" data-no-nav="false">';e+='<div class="image-wrapper">';e+='<div class="image-inner-wrapper" id="'+b+'">';g!=""&&(e+='<img class="image" src="data:image/jpeg;base64,'+$(this).find("thumb_image").text()+
'" width="170px" height="120px" onload="javascript:DrawImage(this,170,120,true);">');e+="</div>";e+='<div class="hover-overlay"></div>';e+='<div class="overlay-icon"><div class="play bicon" data-id="'+a+'"></div></div>';e+='<div class="menu-anchor"></div>';e+="</div>";e+='<div class="details">';e+='<div class="title tooltip fade-out">'+c+"</div>";e+='<div class="sub-title tooltip fade-out" data-type="ar" data-id="'+a+'">'+d+"</div>";e+="</div>";e+="</div>"});$(e).appendTo($("#fileview")).hide().fadeIn("fast");
b=="album"?g_ui_mode.set(6):b=="artist"&&g_ui_mode.set(7);$(".mediaListDiv").removeClass("down");$("div#btnThumbView").css("display","none");$("div#btnListView").css("display","none");$("div#btnUpload").css("display","none");$("div#btnNewDir").css("display","none");$("div#btnPlayImage").css("display","none");$("div#boxSearch").css("display","none");adjustLayout();closeJqmWindow(0);$(".card").click(function(){var a=g_storage.get("openurl")==void 0?"/":g_storage.get("openurl");g_storage.set("data-id",
$(this).attr("data-id"));doPROPFINDMEDIALIST(a,!1,null,"2","0","50","","TIMESTAMP","DESC",$(this).attr("data-id"))});$(".card").mouseenter(function(a){$(this).find(".overlay-icon").hide().fadeIn("fast");$(this).find(".hover-overlay").fadeTo("slow",0.8);a.preventDefault();return!1});$(".card").mouseleave(function(a){$(this).find(".overlay-icon").show().fadeOut("fast");$(this).find(".hover-overlay").fadeTo("fast",0);a.preventDefault();return!1});$(".card .overlay-icon .play").click(function(a){var b=
g_storage.get("openurl"),b=b==void 0?"/":b,d=window.location.host;d.indexOf(":")!=-1&&(d=d.substring(0,d.indexOf(":")));d="http://"+d+":"+g_storage.get("http_port")+"/";g_webdav_client.GETMUSICPLAYLIST(b,$(this).attr("data-id"),function(a,b,c){if(a==200){a=parseXml(c);$(a);var e=[];$(a).find("item").each(function(){var a=$(this).find("title").text(),b=d+$(this).find("sharelink").text(),c=[];c.name=mydecodeURI(a);c.mp3=b;e.push(c)});openAudioPlayerByPlayList(e)}});a.preventDefault();return!1})}
function createOpenUrlUI(a){a==void 0&&(a="/");var b=mydecodeURI(a),c="",e="",f="",j=$("#urlregion-url").width();if(b!="/")for(var b=b.split("/"),a=a.split("/"),d=0;d<b.length;d++)if(!(b[d]==""||g_hide_aidisk_name==1&&b[d]==g_storage.get("usbdiskname"))){e+="/"+a[d];f+=" / <a id='url_path' uhref='"+e+"'>"+b[d]+"</a>";if(String(f).width($("p#openurl").css("font"))>j){c+=" / ...";break}c+=b[1]==g_storage.get("usbdiskname")&&g_hide_aidisk_name==1?" / <a id='url_path' uhref='/"+g_storage.get("usbdiskname")+
e+"'>"+b[d]+"</a>":" / <a id='url_path' uhref='"+e+"'>"+b[d]+"</a>";f=c}$("p#openurl").empty();$("p#openurl").append(c);$("a#url_path").click(function(){doPROPFIND($(this).attr("uhref"))})}
function adjustLayout(){var a=getPageSize(),b=a[0],c=a[0],a=a[1]-35-33;$("#main_region").css("height",a);$("#main_region #main_right_region").css("width",c-parseInt($("#main_region #main_right_region").css("left")));$("#main_region #main_right_region").css("height",a-parseInt($("#main_region #button_panel").height())+7);$("#main_region #button_panel").css("left",$("#main_region #main_right_region").css("left"));$("#main_region #button_panel").css("width",$("#main_region #main_right_region").width());
c=$("#main_left_region").height()-$("#main_left_region #infobar").height();$("#hostview").css("height",c);var e=0;$("#toolbar .albutton").each(function(){$(this).css("display")=="block"&&(e+=$(this).width())});$("#toolbar .alsearch").css("display")=="block"&&(e+=$("#toolbar .alsearch").width());$("#urlregion-url").css("width",$("#toolbar").width()-e-20);createOpenUrlUI(g_storage.get("openurl"));c=$("#main_right_container").height()-$("#main_right_region #infobar").height();$("#main_right_container #hintbar").css("display")==
"block"&&(c-=$("#main_right_container #hintbar").height());$("#fileview").css("height",c);$("#function_help").css("left",$("#main_left_region").width());if(c=$("div#modalWindow"))a=(b-g_modal_window_width)/2,c.css("left",a);a=(b-$(".select-window").width())/2;$(".select-window").css("left",a);$("#header-fixed").css("width",$("#ntl").width());b=$("#header_region").height()+$("#main_right_region #infobar").height()+2;$("#main_right_container #hintbar").css("display")=="block"&&(b+=$("#main_right_container #hintbar").height());
$("#header-fixed").css("top",b);g_fileview_only==1&&($("#button_panel").css("display","none"),$("#main_right_region").css("left","0px"),$("#main_right_region").css("width","100%"),$("#main_right_region").css("height","100%"));$("#audio_player_panel").css("display","block");adjustUploadLayout()}
function showHideAiButton(a){a?g_bshowHideAiButton||($("#button_panel #btnAiMusic").fadeIn("fast"),$("#button_panel #btnAiMusicPopupMenu").fadeIn("fast"),$("#button_panel #btnAiMovie").fadeIn("fast"),$("#button_panel #btnAiPhoto").fadeIn("fast")):g_bshowHideAiButton&&($("#button_panel #btnAiMusic").fadeOut("fast"),$("#button_panel #btnAiMusicPopupMenu").fadeOut("fast"),$("#button_panel #btnAiMovie").fadeOut("fast"),$("#button_panel #btnAiPhoto").fadeOut("fast"));g_bshowHideAiButton=a}
function showHideEditUIRegion(a){a?g_bshowHideEditUIRegion||$("#button_panel #edit_ui_region").fadeIn("fast"):g_bshowHideEditUIRegion&&$("#button_panel #edit_ui_region").fadeOut("fast");g_select_file_count>0||g_select_folder_count>0?(isAiModeView()<0&&$("#btnDeleteSel").removeClass("disable"),$("#btnDownload").removeClass("disable"),$("#btnShareLink").removeClass("disable")):($("#btnDeleteSel").addClass("disable"),$("#btnDownload").addClass("disable"),$("#btnShareLink").addClass("disable"));g_select_file_count+
g_select_folder_count==1&&isAiModeView()<0?$("#btnRename").removeClass("disable"):$("#btnRename").addClass("disable");g_bshowHideEditUIRegion=a}
function refreshSelectWindow(){if(g_select_folder_count>0||g_select_file_count>0){var a=m.getString("btn_select");g_select_folder_count>0&&(a+=" ["+g_select_folder_count+m.getString("title_folder_unit")+"]");g_select_file_count>0&&(a+=" ["+g_select_file_count+m.getString("title_file_unit")+"]");$(".select-window .selected-desc-text").text(a);$(".select-window").fadeIn("fast");showHideSelectModeUI(!0)}else $(".select-window").fadeOut("fast"),showHideSelectModeUI(!1)}
function closeAiMode(){g_storage.set("aimode",-1);$(".mediaListDiv").removeClass("down");$("div#boxSearch").css("display","none");$("div#boxSearch input").val("")}function showHideLoadStatus(a){a?$("#loading").css("display","block"):$("#loading").css("display","none")}
function show_hint_no_mediaserver(){$("#main_right_container #fileview").empty();var a=g_storage.get("http_enable"),b=g_storage.get("misc_http_enable"),c=g_storage.get("misc_http_port"),e=g_storage.get("misc_https_port"),f=window.location.host,j="http",d=c;b==0&&!isPrivateIP()?$("#main_right_container #hintbar").html(m.getString("msg_no_mediaserver")):(a=="0"?(j="http",d=c):a=="1"&&(j="https",d=e),isPrivateIP()?a=j+"://"+f.split(":")[0]:(a=j+"://"+f.split(":")[0],d!=""&&(a+=":"+d)),d=g_storage.get("app_installation_url"),
d==""?a+="/APP_Installation.asp":(d.indexOf("/")!=0&&(d="/"+d),a+=d),d="<a href='"+a+"' target='_blank'>"+m.getString("msg_no_mediaserver")+"</a>",$("#main_right_container #hintbar").html(d));$("#main_right_container #hintbar").show()}
function showHideSelectModeUI(a){a?($("div#boxSearch").hide(),$("div#btnNewDir").hide(),$("div#btnPlayImage").hide(),$("div#btnUpload").hide(),$("div#btnThumbView").hide(),$("div#btnListView").hide(),showHideEditUIRegion(!0)):($("#btnDownload").addClass("disable"),$("#btnShareLink").addClass("disable"),$("#btnDeleteSel").addClass("disable"),$("#btnRename").addClass("disable"),isAiModeView()>=0?($("div#btnNewDir").hide(),$("div#btnUpload").hide(),getAiMode()==1?$("div#btnPlayImage").show():$("div#btnPlayImage").hide(),
$("div#boxSearch").show()):($("div#btnNewDir").show(),$("div#btnUpload").show(),$("div#btnPlayImage").show(),$("div#boxSearch").hide()),$("div#btnThumbView").show(),g_list_view.get()==1?($("div#btnThumbView").show(),$("div#btnListView").hide()):($("div#btnThumbView").hide(),$("div#btnListView").show()),$(".item-check").removeClass("x-view-selected"),$(".item-check").hide(),$(".select-window").fadeOut("fast"),showHideEditUIRegion(!1),$("#function_help").text(""),adjustLayout(),g_select_array=null,
g_select_file_count=g_select_folder_count=0);g_select_mode=a?1:0};var dragenterHandler=function(a){openUploadPanel(1);handleDragOver(a)};
function create_ui_view(a,b,c,e,f,j,d){var g=function(){g_select_array=null;g_select_folder_count=g_select_file_count=0;$("#fileview .wcb").each(function(){$(this).find(".item-check").removeClass("x-view-selected");$(this).find(".item-check").hide();$(this).find(".item-menu").removeClass("x-view-menu-popup");$(this).find(".item-menu").hide();$(this).css("background-color","")});refreshSelectWindow()},h=function(a){var b=a.find(".item-check");b.hasClass("x-view-selected")?(b.removeClass("x-view-selected"),
a.css("background-color","")):(b.addClass("x-view-selected"),a.css("background-color","#00C2EB"));b.show();g_select_array=null;g_select_array=[];g_select_folder_count=g_select_file_count=0;$("#fileview").find(".wcb").each(function(){if($(this).find(".item-check").hasClass("x-view-selected")){var a=$(this).attr("uhref"),b=$(this).attr("isdir"),d=myencodeURI($(this).attr("data-name"));b==1?g_select_folder_count++:g_select_file_count++;g_select_array.push({isdir:b,uhref:a,title:d})}});refreshSelectWindow()};
b.empty();c!=2&&(a=="thumbview"?createThumbView(b,c,e,f,j,d):a=="listview"&&createListView(b,c,e,f,j,d),g_support_html5==1&&(a=document.getElementById("fileview"),c==0?a.addEventListener("dragenter",dragenterHandler,!1):a.removeEventListener("dragenter",dragenterHandler,!1)),$(".item-check").click(function(){var a=$(this).parents(".wcb");h(a)}),$(".item-menu").click(function(){var a=$(this),b=$(this).parents(".wcb");g();a.hasClass("x-view-menu-popup")?(a.removeClass("x-view-menu-popup"),b.css("background-color",
"")):(a.addClass("x-view-menu-popup"),b.css("background-color","#00C2EB"),a.show());h(b)}),$("#fileview .fcb").mouseover(function(){$(this).find(".item-check").show();$(this).find(".item-menu").show();$(this).css("background-color","#00C2EB")}),$("#fileview .fcb").mouseleave(function(){var a=$(this).find(".item-check"),b=$(this).find(".item-menu");a.hasClass("x-view-selected")||$(this).find(".item-check").hide();b.hasClass("x-view-menu-popup")||$(this).find(".item-menu").hide();!a.hasClass("x-view-selected")&&
!b.hasClass("x-view-menu-popup")&&$(this).css("background-color","")}))}
function createThumbView(a,b,c,e,f,j){var d="";b==0&&(d+='<div class="albumDiv fcb" qtype="1" isParent="1" isdir="1" uhref="'+c+'">',d+='<table class="thumb-table-parent">',d+="<tbody>",d+="<tr><td>",d+='<div class="picDiv cb">',d+='<div class="parentDiv bicon"></div></div>',d+="</td></tr>",d+="<tr><td>",d+='<div class="albuminfo">',d+='<a id="list_item" title="'+m.getString("btn_prevpage")+'">'+m.getString("btn_prevpage")+"</a>",d+="</div>",d+="</td></tr>",d+="</tbody>",d+="</table>",d+="</div>");
for(c=0;c<e.length;c++){var g=m.getString("table_filename")+": "+e[c].name;e[c].time!=""&&(g+="\n"+m.getString("table_time")+": "+e[c].time);d+='<div class="albumDiv fcb wcb" ';d+=' title="';d+=g;d+=' qtype="';d+=b;d+='" isParent="0" isdir="1" uhref="';d+=e[c].href;d+='" data-name="';d+=e[c].name;d+='" data-thumb="';d+=e[c].thumb;d+='" online="';d+=e[c].online;d+='" ip="" mac="';d+=e[c].mac;d+='" uid="';d+=e[c].uid;d+='" freadonly="';d+=e[c].freadonly;d+='" fhidden="';d+=e[c].fhidden;d+=e[c].type==
"usbdisk"?'" isusb="1"':'" isusb="0"';d+='">';d+='<table class="thumb-table-parent">';d+="<tbody>";d+="<tr><td>";d+='<div class="picDiv cb" popupmenu="';d+=b=="0"?"1":"0";d+='" uhref="';d+=e[c].href;d+='">';d+=b=="2"?e[c].type=="usbdisk"?'<div id="fileviewicon" class="usbDiv bicon">':e[c].online=="1"?'<div id="fileviewicon" class="computerDiv bicon">':'<div id="fileviewicon" class="computerOffDiv bicon">':'<div id="fileviewicon" class="folderDiv bicon">';e[c].routersyncfolder=="1"&&(d+='<div id="routersyncicon" class="routersyncDiv sicon"></div>');
d+="</div></div>";d+="</td></tr>";d+="<tr><td>";d+='<div class="albuminfo">';d+='<a id="list_item">';d+=e[c].shortname;e[c].online=="0"&&b=="2"&&(d+="("+m.getString("title_offline")+")");d+="</a>";d+="</div>";d+="</td></tr>";d+="</tbody>";d+="</table>";b=="0"&&(d+='<div class="item-check ui-icon"></div>',d+='<div class="item-menu ui-icon"></div>');d+="</div>"}for(c=0;c<f.length;c++){g=m.getString("table_filename")+": "+f[c].name+"\n"+m.getString("table_time")+": "+f[c].time+"\n"+m.getString("table_size")+
": "+f[c].size;d+='<div class="albumDiv fcb wcb"';d+=' title="';d+=g;d+='" qtype="1" isParent="1" isdir="0" uhref="';d+=f[c].href;d+='" data-name="';d+=f[c].name;d+='" matadatatitle="';d+=f[c].matadatatitle;d+='" uid="';d+=f[c].uid;d+='" ext="';d+=h;d+='" freadonly="';d+=f[c].freadonly;d+='" fhidden="';d+=f[c].fhidden;d+='" data-thumb="';d+=f[c].thumb;d+=f[c].type=="usbdisk"?'" isusb="1"':'" isusb="0"';d+='">';d+='<table class="thumb-table-parent">';d+="<tbody>";var h=getFileExt(String(f[c].href));
h.length>5&&(h="");d+="<tr><td>";d+=b=="0"?'<div class="picDiv cb" popupmenu="1" uhref="':'<div class="picDiv cb" popupmenu="0" uhref="';d+=f[c].href;d+='">';d+=h=="jpg"||h=="jpeg"||h=="png"||h=="gif"||h=="bmp"?'<div id="fileviewicon" class="imgfileDiv bicon">':h=="mp3"||h=="m4a"||h=="m4r"||h=="wav"?'<div id="fileviewicon" class="audiofileDiv bicon">':h=="mp4"||h=="rmvb"||h=="m4v"||h=="wmv"||h=="avi"||h=="mpg"||h=="mpeg"||h=="mkv"||h=="mov"||h=="flv"||h=="3gp"||h=="m2v"||h=="rm"?'<div id="fileviewicon" class="videofileDiv bicon">':
h=="doc"||h=="docx"?'<div id="fileviewicon" class="docfileDiv bicon">':h=="ppt"||h=="pptx"?'<div id="fileviewicon" class="pptfileDiv bicon">':h=="xls"||h=="xlsx"?'<div id="fileviewicon" class="xlsfileDiv bicon">':h=="pdf"?'<div id="fileviewicon" class="pdffileDiv bicon">':'<div id="fileviewicon" class="fileDiv bicon">';d+="</div></div>";d+="</td></tr>";d+="<tr><td>";d+='<div class="albuminfo" style="font-size:80%">';d+='<a id="list_item">';d+=f[c].shortname;d+="</a>";d+="</div>";d+="</td></tr>";d+=
"</tbody>";d+="</table>";b=="0"&&(d+='<div class="item-check ui-icon"></div>',d+='<div class="item-menu ui-icon"></div>');d+="</div>"}a.append(d);$(".thumb-table-parent").mousedown(function(a){var b=$(this).parents(".fcb");j(a,b)})}
function createListView(a,b,c,e,f,j){var d="";d+='<table id="ntl" class="table-file-list">';d+="<thead>";d+="<tr>";d+='<th style="width:30px"></th>';d+='<th style="width:40px"></th>';d+='<th style="width:58%">'+m.getString("table_filename")+"</th>";d+='<th style="width:25%">'+m.getString("table_time")+"</th>";d+='<th style="width:7%">'+m.getString("table_size")+"</th>";d+='<th style="width:30px"></th>';d+="</tr>";d+="</thead>";d+="<tbody>";b==0&&(d+='<tr class="listDiv fcb cbp" ',d+='qtype="1" isParent="1" isdir="1" uhref="',
d+=c,d+='" title="'+m.getString("btn_prevpage")+'" online="0">',d+='<td field="check"></td>',d+='<td field="icon"><div id="fileviewicon" class="parentDiv sicon"></td>',d+='<td field="filename" align="left">'+m.getString("btn_prevpage")+"</td>",d+='<td field="time" align="left"></td>',d+='<td field="size" align="left"></td>',d+='<td field="option" align="left"></td>',d+="</tr>");for(c=0;c<e.length;c++)d+='<tr class="listDiv fcb wcb"',d+=' id="list_item" qtype="',d+=b,d+='" isdir="1" uhref="',d+=e[c].href,
d+='" title="',d+=e[c].name,d+='" online="',d+=e[c].online,d+='" ip="" mac="',d+=e[c].mac,d+='" uid="',d+=e[c].uid,d+='" freadonly="',d+=e[c].freadonly,d+='" fhidden="',d+=e[c].fhidden,d+='" data-thumb="',d+=e[c].thumb,d+='" data-name="',d+=e[c].name,d+=e[c].type=="usbdisk"?'" isusb="1"':'" isusb="0"',d+='">',d+='<td field="check">',b=="0"&&(d+='<div class="checklist">',d+='<div class="item-check ui-icon"></div>',d+="</div>"),d+="</td>",d+='<td field="icon">',d+=b=="2"?e[c].type=="usbdisk"?'<div id="fileviewicon" class="usbDiv sicon">':
e[c].online=="1"?'<div id="fileviewicon" class="computerDiv sicon">':'<div id="fileviewicon" class="computerOffDiv sicon">':'<div id="fileviewicon" class="folderDiv sicon">',d+="</td>",d+='<td field="filename" align="left">'+e[c].name+"</td>",d+='<td field="time" align="left">'+e[c].time+"</td>",d+='<td field="size" align="left"></td>',d+='<td field="option" align="left">',b=="0"&&(d+='<div class="checklist">',d+='<div class="item-menu ui-icon"></div>',d+="</div>"),d+="</td>",d+="</tr>";for(c=0;c<
f.length;c++)e=getFileExt(String(f[c].href)),e.length>5&&(e=""),d+='<tr class="listDiv fcb wcb"',d+=' id="list_item" qtype="1" isdir="0" uhref="',d+=f[c].href,d+='" title="',d+=f[c].name,d+='" matadatatitle="',d+=f[c].matadatatitle,d+='" uid="',d+=f[c].uid,d+='" ext="',d+=e,d+='" freadonly="',d+=f[c].freadonly,d+='" fhidden="',d+=f[c].fhidden,d+='" data-thumb="',d+=f[c].thumb,d+='" data-name="',d+=f[c].name,d+=f[c].type=="usbdisk"?'" isusb="1"':'" isusb="0"',d+='">',d+='<td field="check">',b=="0"&&
(d+='<div class="checklist">',d+='<div class="item-check ui-icon"></div>',d+="</div>"),d+="</td>",d+='<td field="icon">',d+=e=="jpg"||e=="jpeg"||e=="png"||e=="gif"||e=="bmp"?'<div id="fileviewicon" class="imgfileDiv sicon">':e=="mp3"||e=="m4a"||e=="m4r"||e=="wav"?'<div id="fileviewicon" class="audiofileDiv sicon">':e=="mp4"||e=="rmvb"||e=="m4v"||e=="wmv"||e=="avi"||e=="mpg"||e=="mpeg"||e=="mkv"||e=="mov"||e=="flv"||e=="3gp"||e=="m2v"||e=="rm"?'<div id="fileviewicon" class="videofileDiv sicon">':e==
"doc"||e=="docx"?'<div id="fileviewicon" class="docfileDiv sicon">':e=="ppt"||e=="pptx"?'<div id="fileviewicon" class="pptfileDiv sicon">':e=="xls"||e=="xlsx"?'<div id="fileviewicon" class="xlsfileDiv sicon">':e=="pdf"?'<div id="fileviewicon" class="pdffileDiv sicon">':'<div id="fileviewicon" class="fileDiv sicon">',d+="</td>",d+='<td field="filename" align="left">'+f[c].name+"</td>",d+='<td field="time" align="left">'+f[c].time+"</td>",d+='<td field="size" align="left">'+f[c].size+"</td>",d+='<td field="option" align="left">',
b=="0"&&(d+='<div class="checklist">',d+='<div class="item-menu ui-icon"></div>',d+="</div>"),d+="</td>",d+="</tr>";d+="</tbody>";d+="</table>";d+='<table id="header-fixed" class="table-file-list"></table>';a.append(d);$("td[field=icon], td[field=filename], td[field=time], td[field=size]").mousedown(function(a){j(a,$(this).parent(".listDiv"))});var g=$("#ntl").offset().top,a=$("#ntl > thead").clone(),h=$("#header-fixed").append(a);$("#header-fixed").css("width",$("#ntl").width());$("#fileview").bind("scroll",
function(){var a=$(this).scrollTop();a>=g&&h.is(":hidden")?h.show():a<g&&h.hide()})};var g_image_player={loc:"",page_width:0,page_height:0,file_array:null,show:function(a,b,c,e){this.loc=a;this.page_width=b;this.page_height=c;this.file_array=e;a=[];for(b=0;b<this.file_array.length;b++)c=getFileExt(this.file_array[b].href),(c=="jpg"||c=="jpeg"||c=="png"||c=="gif")&&a.push(this.file_array[b]);if(a.length==0)alert(m.getString("msg_no_image_list"));else{for(b=c=0;b<a.length;b++)this.loc==a[b].href&&(c=b);e="";e+='<div id="image_slide_show" class="barousel unselectable" style="height: 0; width: 0; position: fixed; background-color: rgb(0, 0, 0); left: ';
e+=this.page_width/2;e+="px; top: ";e+=this.page_height/2;e+='px; z-index: 2999;">';e+='<div class="barousel_image">';for(b=0;b<a.length;b++){var f=window.location.protocol+"//"+window.location.host+a[b].href;e+=b==c?'<img src="" path="'+f+'" alt="" class="default"/>':'<img src="" path="'+f+'" alt="" class=""/>'}e+="</div>";e+='<div class="barousel_nav">';e+='<div class="barousel_content transparent" style="display: block; ">';for(b=0;b<a.length;b++)e+='<div class="',b==c&&(e+="default"),e+='" style="display: none; ">',
e+='<p class="header">'+a[b].name+"</p>",e+="</div>";e+="</div>";e+="</div>";e+="</div>";$(e).animate({width:"100%",height:"100%",left:"0px",top:"0px"},200,null,null).appendTo("body");$("#image_slide_show").barousel({navType:2,manualCarousel:1,contentResize:0,startIndex:c});$(".facebook_upload").click(function(){var a=$("div#modalWindow"),b=$(this).attr("file"),c=myencodeURI(b.substring(b.lastIndexOf("/")+1,b.length)),b=b.substring(0,b.lastIndexOf("/")),e=window.location.host;e.indexOf(":")!=-1&&
(e=e.substring(0,e.indexOf(":")));e="http://"+e+":"+g_storage.get("http_port")+"/";g_webdav_client.GSL(b,b,c,0,0,function(b,d,f){b==200&&(b=parseXml(f),b=$(b).find("sharelink").text(),b=e+b,g_modal_url="http://www.efroip.com/efroip/fbtest/fb.html?v="+b+"&b="+mydecodeURI(c)+"&d="+window.location.href,g_modal_window_width=600,g_modal_window_height=320,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text("Upload to Facebook"),a&&a.jqmShow(),$("#image_slide_show").remove())})});$(".picassa_upload").click(function(){var a=
$("div#modalWindow"),b=$(this).attr("file"),c=myencodeURI(b.substring(b.lastIndexOf("/")+1,b.length)),b=b.substring(0,b.lastIndexOf("/")),e=window.location.host;e.indexOf(":")!=-1&&(e=e.substring(0,e.indexOf(":")));e="http://"+e+":"+g_storage.get("http_port")+"/";g_webdav_client.GSL(b,b,c,0,0,function(b,d,f){b==200&&(b=parseXml(f),b=$(b).find("sharelink").text(),b=e+b,g_modal_url="http://www.efroip.com/efroip/google/index.html?v="+b+"&b="+mydecodeURI(c)+"&d="+window.location.href,g_modal_window_width=
600,g_modal_window_height=320,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text("Upload to Facebook"),a&&a.jqmShow(),$("#image_slide_show").remove())})});a=null}}};var g_audioPlayer=null,g_audio_playlist=[],g_onPlaying=!1;function openAudioPlayer(a){for(var b=[],c=0;c<g_file_array.length;c++)getFileExt(g_file_array[c].href)=="mp3"&&b.push(g_file_array[c]);if(b.length==0)alert(m.getString("msg_no_image_list"));else{for(var e="",f=0,c=0;c<b.length;c++){var j=b[c].href;a==j&&(f=c);e+=j;c!=b.length-1&&(e+=",")}get_mp3_url(e,!0,function(a){g_audioPlayer.showHideAudioPlayerWindow(!0,function(){g_audioPlayer.addPlaylist(a,f)})})}}
function openAudioPlayerByPlayList(a){a!=null&&!(a.length<=0)&&(g_audioPlayer.addPlaylist(a,0),g_audioPlayer.showHideAudioPlayerWindow(!0))}
function getAudioPlayerLayout(){var a="";a+="<div id='audioPlayerWindow' class='unselectable'>";a+='<div id="audio-player-box">';a+='<script type="text/javascript" src="/smb/js/jplayer/jquery.jplayer.min.js"><\/script>';a+='<link rel="stylesheet" href="/smb/css/jplayer.blue.monday.css" type="text/css">';a+='<div id="jquery_jplayer_1" class="jp-jplayer"></div>';a+='<div id="jp_container_1" class="jp-audio">';a+='<div class="jp-type-playlist">';a+='<div id="jp_title_1" class="jp-title">';a+="<ul>";
a+="<li>Loading...</li>";a+="</ul>";a+="</div>";a+='<div id="jp_interface_1" class="jp-gui jp-interface">';a+='<ul class="jp-controls">';a+='<li><a href="javascript:;" class="jp-previous" tabindex="1">previous</a></li>';a+='<li><a href="javascript:;" class="jp-play" tabindex="1" style="display: block; ">play</a></li>';a+='<li><a href="javascript:;" class="jp-pause" tabindex="1" style="display: block; ">pause</a></li>';a+='<li><a href="javascript:;" class="jp-next" tabindex="1">next</a></li>';a+='<li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>';
a+='<li><a href="javascript:;" class="jp-mute" tabindex="1" title="mute">mute</a></li>';a+='<li><a href="javascript:;" class="jp-volume-max" tabindex="1" title="max volume">max volume</a></li>';a+="</ul>";a+='<div class="jp-progress">';a+='<div class="jp-seek-bar" style="width: 100%; ">';a+='<div class="jp-play-bar" style="width: 46.700506341691536%; "></div>';a+="</div>";a+="</div>";a+='<div class="jp-volume-bar">';a+='<div class="jp-volume-bar-value" style="width: 31.979694962501526%; "></div>';
a+="</div>";a+='<div class="jp-duration-bar">';a+='<div class="jp-duration">00:00</div>';a+='<div class="jp-split">/</div>';a+='<div class="jp-current-time">00:00</div>';a+="</div>";a+="</div>";a+='<div id="jp_playlist_1" class="jp-playlist">';a+="<ul></ul>";a+="</div>";a+="</div>";a+="</div>";a+='<div class="jp-no-solution" style="display: none; ">';a+="<span>Update Required</span>";a+='To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.';
a+="</div>";a+='<a id="audio-player-box-playlist" class="sicon" href="#" rel="playlist">Playlist</a>';a+='<a id="audio-player-box-hide" class="sicon" href="#" rel="close">Hide</a>';a+='<a id="audio-player-box-close" class="sicon" href="#" rel="close">Close</a>';a+="</div>";a+="</div>";a+="<div id='audioPlayerStatusWindow' class='bicon' style='display:none'>";a+="<div id='close-button'></div>";a+="<div id='status-bar'>";a+="<span id='status'></span>";a+="</div>";a+="</div>";return a}
function get_mp3_url(a,b,c){if(a!=""){var e=g_audio_playlist,f=a.split(","),j=0,d=!1;g_audio_playlist=[];for(a=0;a<e.length;a++)for(var g=0;g<f.length;g++)e[a].source==f[g]&&(g_audio_playlist.push(e[a]),f.splice(g,1),g=-1);if(b){var h=window.location.host;h.indexOf(":")!=-1&&(h=h.substring(0,h.indexOf(":")));var h="http://"+h+":"+g_storage.get("http_port")+"/",k=setInterval(function(){if(d==!1)if(j<0||j>f.length-1)clearInterval(k),c(g_audio_playlist);else{var a=f[j],b=a.substring(a.lastIndexOf("/")+
1,a.length),e=a.substring(0,a.lastIndexOf("/"));d=!0;g_webdav_client.GSL(e,e,b,0,0,function(c,e,f){if(c==200)c=parseXml(f),c=$(c).find("sharelink").text(),c=h+c,d=!1,e=[],e.source=a,e.name=mydecodeURI(b),e.mp3=c,g_audio_playlist.push(e),j++})}},100)}else{for(a=0;a<f.length;a++)b=f[a],e=b.substring(b.lastIndexOf("/")+1,b.length),b.substring(0,b.lastIndexOf("/")),g=[],g.source=b,g.name=mydecodeURI(e),g.mp3=b,g_audio_playlist.push(g);c(g_audio_playlist)}}}
function initAudioPlayer(){var a=function(a,b){var c=this;this.statusMarqueeTimer=this.clsoeAudioPlayerWindowTimer=0;this.instance=a;this.playlist=null;this.options=b;this.playTitle="";this.current=0;this.showAudioList=!1;this.cssId={jPlayer:"jquery_jplayer_","interface":"jp_interface_",playlist:"jp_playlist_",playtitle:"jp_title_"};this.cssSelector={};$.each(this.cssId,function(a,b){c.cssSelector[a]="#"+b+c.instance});this.options.cssSelectorAncestor||(this.options.cssSelectorAncestor=this.cssSelector["interface"]);
$(this.cssSelector.jPlayer).jPlayer(this.options);var e=this.cssSelector["interface"]+" .jp-previous";$(e).click(function(){c.playlistPrev();$(this).blur();return!1});e=this.cssSelector["interface"]+" .jp-next";$(e).click(function(){c.playlistNext();$(this).blur();return!1});$("#audioPlayerWindow").mousemove(function(){c.startStopRunAudioPlayerWindowTimer(!1)});$("#audioPlayerWindow").mouseleave(function(){c.startStopRunAudioPlayerWindowTimer(!0)});$("#audio-player-box-hide").click(function(){c.showHideAudioPlayerWindow(!1);
return!1});$("#audio-player-box-close").click(function(){if(g_onPlaying&&!confirm(m.getString("msg_close_audio_window_warning")))return!1;c.closeAudioPlayWindow();return!1});$("#audio-player-box-playlist").click(function(){c.showHideAudioList(!c.showAudioList)});$("#audioPlayerStatusWindow").click(function(){c.showHideAudioPlayerWindow(!0)});$("#audioPlayerStatusWindow #close-button").click(function(){if(g_onPlaying&&!confirm(m.getString("msg_close_audio_window_warning")))return!1;c.closeAudioPlayWindow();
return!1})};a.prototype={getPlayTitle:function(){return this.playTitle},startStopRunAudioPlayerStatus:function(a){a?$("#audioPlayerStatusWindow").fadeIn("slow",function(){this.statusMarqueeTimer=setInterval(function(){var a=String($("#audioPlayerStatusWindow #status").text()).width($("#audioPlayerStatusWindow #status").css("font"));$("#audioPlayerStatusWindow #status").animate({left:-a},5E3,function(){$("#audioPlayerStatusWindow #status").css("left",80)})},500)}):(clearInterval(this.statusMarqueeTimer),
$("#audioPlayerStatusWindow").css("display","none"))},startStopRunAudioPlayerWindowTimer:function(a){var b=this;a?b.clsoeAudioPlayerWindowTimer=setTimeout(function(){b.showHideAudioPlayerWindow(!1)},1E4):clearInterval(b.clsoeAudioPlayerWindowTimer)},showHideAudioPlayerWindow:function(a,b){var c=this;a?(c.startStopRunAudioPlayerWindowTimer(!1),c.startStopRunAudioPlayerStatus(!1),c.showHideAudioList(!1),$("#audioPlayerWindow").css("display")=="none"?$("#audioPlayerWindow").fadeIn(500,function(){c.startStopRunAudioPlayerWindowTimer(!0);
b&&b()}):(c.startStopRunAudioPlayerWindowTimer(!0),b&&b())):$("#audioPlayerWindow").css("display")=="block"?$("#audioPlayerWindow").fadeOut(500,function(){c.startStopRunAudioPlayerStatus(!0);c.showHideAudioList(!1);b&&b()}):(c.startStopRunAudioPlayerStatus(!0),c.showHideAudioList(!1),b&&b())},showHideAudioInterface:function(a){a?$("#jp_interface_1").css("display","block"):$("#jp_interface_1").css("display","none")},showHideAudioList:function(a){a?$(".jp-playlist").css("display","block"):$(".jp-playlist").css("display",
"none");this.showAudioList=a},setPlaylist:function(a){this.playlist=a;this.displayPlaylist();this.current=0;this.playlistInit(!0);$("#playlist").css("visibility","visible");this.showHideAudioInterface(!0);this.showHideAudioList(!1)},addPlaylist:function(a,b){this.playlist=a;this.displayPlaylist();this.current=b;this.playlistInit(!0);$("#playlist").css("visibility","visible");this.showHideAudioInterface(!0);this.showHideAudioList(!1)},displayPlaylist:function(){if(!(this.playlist==null||this.playlist==
void 0)){var a=this;$(this.cssSelector.playlist+" ul").empty();for(i=0;i<this.playlist.length;i++){var b=i===this.playlist.length-1?"<li class='jp-playlist-last'>":"<li>";b+="<a href='#' id='"+this.cssId.playlist+this.instance+"_item_"+i+"' tabindex='1'>"+this.playlist[i].name+"</a>";$(this.cssSelector.playlist+" ul").append(b);$(this.cssSelector.playlist+"_item_"+i).data("index",i).click(function(){var b=$(this).data("index");a.current!==b?a.playlistChange(b):$(a.cssSelector.jPlayer).jPlayer("play");
$(this).blur();return!1})}}},playlistInit:function(a){a?this.playlistChange(this.current):this.playlistConfig(this.current)},playlistConfig:function(a){$(this.cssSelector.playlist+"_item_"+this.current).removeClass("jp-playlist-current").parent().removeClass("jp-playlist-current");$(this.cssSelector.playlist+"_item_"+a).addClass("jp-playlist-current").parent().addClass("jp-playlist-current");this.current=parseInt(a);this.playTitle=a=this.playlist[this.current].name;$(this.cssSelector.playtitle+" li").attr("title",
a);$(this.cssSelector.playtitle+" li").text(a);$(this.cssSelector.jPlayer).jPlayer("setMedia",this.playlist[this.current])},playlistChange:function(a){this.playlistConfig(a);$(this.cssSelector.jPlayer).jPlayer("play")},playlistNext:function(){this.playlistChange(this.current+1<this.playlist.length?this.current+1:0)},playlistPrev:function(){this.playlistChange(this.current-1>=0?this.current-1:this.playlist.length-1)},closeAudioPlayWindow:function(){$(this.cssSelector.jPlayer).jPlayer("stop");this.startStopRunAudioPlayerStatus(!1);
this.startStopRunAudioPlayerWindowTimer(!1);$("#audioPlayerStatusWindow").hide();$("#audioPlayerWindow").hide()}};var b="html,flash",c="mp3",e=navigator.userAgent;if(e.indexOf("Chrome")!=-1||e.indexOf("Safari")!=-1&&(isMacOS()||isWinOS()))b="html",c="mp3";else if(isIE()||e.indexOf("Firefox")!=-1||e.indexOf("Opera")!=-1)b="flash",c="mp3";g_audioPlayer=new a("1",{ready:function(){},ended:function(){g_audioPlayer.playlistNext();g_storage.set("stopLogoutTimer","0")},play:function(){$(this).jPlayer("pauseOthers");
g_storage.set("stopLogoutTimer","1")},playing:function(){$("#audioPlayerStatusWindow #status").text("playing: "+g_audioPlayer.getPlayTitle());g_onPlaying=!0;g_storage.set("stopLogoutTimer","1")},pause:function(){$("#audioPlayerStatusWindow #status").text("pause: "+g_audioPlayer.getPlayTitle());g_onPlaying=!1;g_storage.set("stopLogoutTimer","0")},stop:function(){g_onPlaying=!1;g_storage.set("stopLogoutTimer","0")},swfPath:"/smb/js/jplayer/",supplied:c,solution:b,wmode:"window",errorAlerts:!1,warningAlerts:!1,
error:function(a){a.jPlayer.error.type=="e_no_solution"&&($(".jp-no-solution").html(m.getString("title_install_flash")),$(".jp-no-solution").css("display","block"))}})};var this_upload_files=[],g_upload_handler=null,g_upload_option=0;
function openUploadPanel(a){isBrowser("msie")&&getInternetExplorerVersion()<=9?(a=$("div#modalWindow"),g_modal_url="/smb/css/upload_file.html",g_modal_window_width=600,g_modal_window_height=150,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_upload_file")),a&&a.jqmShow()):(g_upload_mode=1,g_upload_option=a,$("div#btnNewDir").hide(),$("div#btnUpload").hide(),$("div#btnPlayImage").hide(),$("div#boxSearch").hide(),$("div#btnListView").hide(),$("div#btnThumbView").hide(),
$("#btn_show_upload_panel").hide(),$("#function_help").text(m.getString("msg_uploadmode_help")),createUploadLayout(),refreshUploadLayout(),$("#upload_panel").fadeIn("fast",function(){for(var a=0;a<this_upload_files.length;a++){var c=this_upload_files[a];c.status=="done"&&$("#upload_file_list li#"+c.id).fadeOut("slow")}}))}
function closeUploadPanel(a){g_upload_mode=0;g_reload_page=a;g_storage.set("stopLogoutTimer","0");$("div#btnNewDir").css("display","block");$("div#btnUpload").css("display","block");$("div#btnPlayImage").css("display","block");g_list_view.get()==1?($("div#btnListView").css("display","none"),$("div#btnThumbView").css("display","block")):($("div#btnListView").css("display","block"),$("div#btnThumbView").css("display","none"));$("div#btnCancelUpload").css("display","none");$("#function_help").text("");
this_upload_files.length<=0?$("#btn_show_upload_panel").hide():$("#btn_show_upload_panel").show();refreshUploadLayout();$("#upload_panel").fadeOut("fast");a==1&&(a=addPathSlash(g_storage.get("openurl")),doPROPFIND(a))}
function hideUploadPanel(){closeUploadPanel(1);g_upload_mode=0;g_storage.set("stopLogoutTimer","0");$("div#btnNewDir").css("display","block");$("div#btnUpload").css("display","block");$("div#btnPlayImage").css("display","block");g_list_view.get()==1?($("div#btnListView").css("display","none"),$("div#btnThumbView").css("display","block")):($("div#btnListView").css("display","block"),$("div#btnThumbView").css("display","none"));$("div#btnCancelUpload").css("display","none");$("#function_help").text("");
refreshUploadLayout();adjustLayout();$("#upload_panel").fadeOut("fast");var a=addPathSlash(g_storage.get("openurl"));doPROPFIND(a)}
function createUploadLayout(){if($("#main_table").length<=0){var a="";a+='<table id="main_table" width="100%" height="auto" border="0" align="center" cellpadding="0" cellspacing="0">';a+="<tr>";a+="<td>";a+='<div id="uploadRegion" class="upload-x" style="height:auto;">';a+='<table id="upload-container" cellpadding="0" cellspacing="0" class="upload-dropzone-parent drag-drop-supported">';a+="<tbody>";a+="<tr>";a+='<td class="upload-dropzone-cell">';a+='<table id="drop-zone-label" cellpadding="0" cellspacing="0" class="upload-dropzone">';
a+="<tbody>";a+="<tr>";a+="<td>";a+='<div class="upload-drop-here">'+m.getString("hint_selfile1")+"</div>";a+='<div class="upload-drop-alt">'+m.getString("hint_selfile2")+"</div>";a+='<div id="select-files-parent-label" class="select-files">';a+='<span class="upload-select-here">'+m.getString("hint_selfile3")+"</span>";a+='<input type="file" id="files" multiple/>';a+="</div>";a+="<div id=\"select-directorys-parent-label\" class='select-directorys'>";a+='<span class="upload-select-directorys-here"></span>';
a+='<input type="file" id="directorys" webkitdirectory="" directory=""/>';a+="</div>";a+="<div>";a+='<a href="#" id="upload-files-list-view" class="ml-btn-2">'+m.getString("hint_selfile7")+"</a>";a+="</div>";a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+=' <div id="upload-file-list-container">';a+='<div style="text-align:left"><a href="#" id="select-files-again" class="ml-btn-2">'+m.getString("hint_selfile8")+"</a></div>";a+='<output id="upload_file_list">';
a+="</output>";a+="</div>";a+="</div>";a+="</td>";a+="</tr>";a+='<tr style="height:25px">';a+="<td>";a+='<div id="div_upload" style="display:none;width:100%;">';a+='<div class="ui-progress-bar ui-container" id="progress_bar">';a+='<div class="ui-progress" style="width: 0%;">';a+="</div>";a+='<span class="ui-label" style="display:none;">';a+='<b class="value">7%</b>';a+="</span>";a+="</div>";a+="</div>";a+="</td>";a+="</tr>";a+='<tr style="height:60px">';a+="<td>";a+='<div class="table_block_footer" style="text-align:right">';
a+='<a id="start_upload" class="ml-btn-1 readBytesButtons">'+m.getString("btn_upload")+"</a>";a+='<a id="stop_upload" class="ml-btn-1">'+m.getString("btn_cancelupload")+"</a>";a+='<a id="close" class="ml-btn-1 btnStyle">'+m.getString("btn_close")+"</a>";a+="</div>";a+="</td>";a+="</tr>";a+="</table>";$("#upload_panel div").empty();$(a).appendTo($("#upload_panel div"));document.getElementById("files")&&document.getElementById("files").addEventListener("change",handleFileSelect,!1);document.getElementById("directorys")&&
document.getElementById("directorys").addEventListener("change",handleFileSelect,!1);$("#upload-files-list-view").click(function(){$("#upload-container").hide();$("#upload-file-list-container").fadeIn()});$("#select-files-again").click(function(){$("#upload-container").fadeIn();$("#upload-file-list-container").hide()});$("#start_upload").click(function(){start_upload()});$("#stop_upload").click(function(){confirmCancelUploadFile()!=0&&closeUploadPanel()});$("#close").click(function(){closeUploadPanel(1)});
$("#btn_show_upload_panel").click(function(){openUploadPanel(1)})}}
function refreshUploadLayout(){this_upload_files.length<=0?($("#upload-file-list-container").hide(),$("#upload-container").show()):($("#upload-file-list-container").show(),$("#upload-container").hide());if(g_storage.get("isOnUploadFile")=="0"){if($("#select-files-again").show(),$("#start_upload").show(),$("#stop_upload").hide(),$("#div_upload").hide(),g_upload_option==0?($(".select-files").show(),$(".select-directorys").show()):g_upload_option==1?($(".select-files").show(),$(".select-directorys").hide()):
g_upload_option==2?($(".select-files").hide(),$(".select-directorys").show()):($(".select-files").hide(),$(".select-directorys").hide()),g_support_html5==1){var a=document.getElementById("uploadRegion");a&&(a.addEventListener("dragover",handleDragOver,!1),a.addEventListener("drop",handleFileSelect,!1));$(".upload-drop-here").css("display","block");$(".upload-drop-alt").css("display","block")}}else $("#select-files-again").hide(),$("#start_upload").hide(),$("#stop_upload").show(),$("#div_upload").show();
adjustUploadLayout()}function adjustUploadLayout(){var a=$("#upload_panel").height()-50;$("#main_table").css("height",a);$("#uploadRegion").css("height",a-120);$("#upload-file-list-container").css("height",a-144)}
function traverseFileTree(a,b){b=b||"";a.isFile?a.file(function(a){var e={};e.id="upload_"+(this_upload_files.length+1);e.status="Init";e.thepath=b;e.thefile=a;this_upload_files.push(e);outputUploadResult()}):a.isDirectory&&a.createReader().readEntries(function(c){for(var e=0;e<c.length;e++)traverseFileTree(c[e],b+a.name+"/")})}
function handleFileSelect(a){if(g_storage.get("isOnUploadFile")==1)return a.stopPropagation(),a.preventDefault(),!0;var b;if(a.type=="drop")if(a.stopPropagation(),a.preventDefault(),a.dataTransfer.items!=void 0){b=a.dataTransfer.items;b.length>0&&$("#upload-container").hide();for(a=0;a<b.length;a++){var c=b[a].webkitGetAsEntry();c&&traverseFileTree(c)}return}else b=a.dataTransfer.files;else b=a.target.files;for(a=0;c=b[a];a++)if(!(c.name=="."||c.name=="..")){var e="";c.webkitRelativePath&&(e=String(c.webkitRelativePath).replace(c.name,
""));var f={};f.id="upload_"+(this_upload_files.length+1);f.status="Init";f.thepath=e;f.thefile=c;this_upload_files.push(f)}$("#upload-container").hide();outputUploadResult()}function handleDragOver(a){a.stopPropagation();a.preventDefault()}
function outputUploadResult(){for(var a=[],b=0,c;c=this_upload_files[b];b++){var e=size_format(c.thefile.size),f=String(c.id);g_storage.get("isOnUploadFile")==1?a.push("<li><strong>",c.thepath+c.thefile.name,"</strong> "," - ",e,m.getString("upload_item"),' [ <span id="status">',m.getString(c.status),"</span> ] ","</li>"):a.push('<li id="',f,'"><strong>',c.thepath+c.thefile.name,"</strong> "," - ",e,m.getString("upload_item"),' [ <span id="status">',m.getString(c.status),"</span> ]",'<span class="ui-icon" id="delete_item" item="',
f,'"></span></li>')}document.getElementById("upload_file_list").innerHTML='<ul id="nav">'+a.join("")+"</ul>";g_storage.get("isOnUploadFile")==0&&($("#upload-file-list-container").fadeIn(),$("span#delete_item").click(function(){var a=$(this).attr("item");this_upload_files.splice(a,1);outputUploadResult()}))}
function start_upload(){if(this_upload_files.length){$("#select-files-again").hide();$("#start_upload").hide();$("#stop_upload").show();$("span#delete_item").hide();g_storage.set("isOnUploadFile","1");g_storage.set("stopLogoutTimer","1");var a=addPathSlash(g_storage.get("openurl"));g_upload_handler=null;g_upload_handler=new uploadlib.WebDAVUploadHandler;g_upload_handler.initialize(a,this_upload_files,webdav_put_progress_callbackfunction,webdav_put_complete_callbackfunction);g_upload_handler.uploadFile()}else alert(m.getString("warn_selfile"))}
function stop_upload(){this_upload_files&&this_upload_files.length>0&&this_upload_files.splice(0,this_upload_files.length);$("#select-files-again").show();g_storage.set("stopLogoutTimer","0");g_storage.set("isOnUploadFile","0");g_upload_handler=null;outputUploadResult()}
function webdav_put_progress_callbackfunction(a,b,c,e,f){f==100?showUploadProgress(m.getString("msg_upload_complete"),f):(showUploadProgress(m.getString("msg_upload1")+b+m.getString("msg_upload2")+" "+f.toFixed(2)+" %",f),$("#upload_file_list li#"+a+" span#status").text(m.getString(c)+", "+e.toFixed(2)+"%"))}
function webdav_put_complete_callbackfunction(a,b,c,e,f){c=="UploadFail"&&alert(m.getString(e));c=="done"&&$("#upload_file_list li#"+a).fadeOut("slow");f==!0&&(showUploadProgress(m.getString("msg_upload_complete"),100),stop_upload(),closeUploadPanel&&closeUploadPanel(1))}
function showUploadProgress(a,b){$("#div_upload").show();if(b<=0)$(".ui-label").css("display","none");else{var c=$("#progress_bar");$(".ui-progress",c).css("width",b.toFixed(2)+"%");$(".ui-label").show();$(".ui-label .value").text(a)}}function confirmCancelUploadFile(){if(g_storage.get("isOnUploadFile")==1){if(confirm(m.getString("msg_confirm_cancel_upload"))!=!0)return 0;stop_upload()}return 1};var g_thumb_loader={_container:null,_timer:null,_array:null,_onLoading:!1,init:function(a){var b=this;this._container=a;this.stop();this._array=[];this._container.find(".fcb").each(function(){$(this).attr("data-thumb")==1&&b._array.push({item_con:$(this).find("#fileviewicon"),uhref:$(this).attr("uhref"),filename:$(this).attr("data-name")})})},setImage:function(a,b){var c='<img src="data:image/jpeg;base64,'+b+'" width="80px" height="60px" onload="javascript:DrawImage(this,80,60);"></img>';a.attr("class",
"");$(c).appendTo(a)},start:function(){var a=this;if(!(this._array.length<=0))this._timer=setInterval(function(){if(a._array.length<=0)clearInterval(a._timer);else if(a._onLoading!=!0){a._onLoading=!0;var b=a._array[0],c=b.item_con,e=b.uhref,b=myencodeURI(b.filename),f=g_storage.get("openurl")==void 0?"/":g_storage.get("openurl"),e=g_storage.getl(e);e!=void 0&&e!=""?(a.setImage(c,e),a._array.shift(),a._onLoading=!1):g_webdav_client.GETTHUMBIMAGE(f,b,function(b,d,e){b==200&&(b=parseXml(e),b=$(b).find("thumb_image").text(),
b!=""&&a.setImage(c,b));a._array.shift();a._onLoading=!1})}},100)},stop:function(){this._array=null;clearInterval(this._timer)}};(function(a,b){function c(a){for(var a=a.split(/\s+/),b=[],c=0,d;d=a[c];c++)d=d[0].toUpperCase(),b.push(d);return b}function e(b){return b.id&&a('label[for="'+b.id+'"]').val()||b.name}function f(c,d,t){t||(t=0);d.each(function(){var d=a(this),w=this,n=this.nodeName.toLowerCase(),g,o;n=="label"&&d.find("input, textarea, select").length&&(g=d.text(),d=d.children().first(),w=d.get(0),n=w.nodeName.toLowerCase());switch(n){case "menu":o={name:d.attr("label"),items:{}};t=f(o.items,d.children(),t);break;
case "a":case "button":o={name:d.text(),disabled:!!d.attr("disabled"),callback:function(){return function(){d.click()}}()};break;case "menuitem":case "command":switch(d.attr("type")){case b:case "command":case "menuitem":o={name:d.attr("label"),disabled:!!d.attr("disabled"),callback:function(){return function(){d.click()}}()};break;case "checkbox":o={type:"checkbox",disabled:!!d.attr("disabled"),name:d.attr("label"),selected:!!d.attr("checked")};break;case "radio":o={type:"radio",disabled:!!d.attr("disabled"),
name:d.attr("label"),radio:d.attr("radiogroup"),value:d.attr("id"),selected:!!d.attr("checked")};break;default:o=b}break;case "hr":o="-------";break;case "input":switch(d.attr("type")){case "text":o={type:"text",name:g||e(w),disabled:!!d.attr("disabled"),value:d.val()};break;case "checkbox":o={type:"checkbox",name:g||e(w),disabled:!!d.attr("disabled"),selected:!!d.attr("checked")};break;case "radio":o={type:"radio",name:g||e(w),disabled:!!d.attr("disabled"),radio:!!d.attr("name"),value:d.val(),selected:!!d.attr("checked")};
break;default:o=b}break;case "select":o={type:"select",name:g||e(w),disabled:!!d.attr("disabled"),selected:d.val(),options:{}};d.children().each(function(){o.options[this.value]=a(this).text()});break;case "textarea":o={type:"textarea",name:g||e(w),disabled:!!d.attr("disabled"),value:d.val()};break;case "label":break;default:o={type:"html",html:d.clone(!0)}}o&&(t++,c["key"+t]=o)});return t}a.support.htmlMenuitem="HTMLMenuItemElement"in window;a.support.htmlCommand="HTMLCommandElement"in window;a.support.eventSelectstart=
"onselectstart"in document.documentElement;if(!a.ui||!a.ui.widget){var j=a.cleanData;a.cleanData=function(b){for(var c=0,d;(d=b[c])!=null;c++)try{a(d).triggerHandler("remove")}catch(e){}j(b)}}var d=null,g=!1,h=a(window),k=0,l={},r={},x={},y={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");
else{var c=this.offset();c.top+=this.outerHeight();c.left+=this.outerWidth()/2-b.outerWidth()/2;b.css(c)}},position:function(a,b,c){if(!b&&!c)a.determinePosition.call(this,a.$menu);else{var b=b==="maintain"&&c==="maintain"?a.$menu.position():{top:c,left:b},c=h.scrollTop()+h.height(),d=h.scrollLeft()+h.width(),e=a.$menu.height(),f=a.$menu.width();b.top+e>c&&(b.top-=e);b.left+f>d&&(b.left-=f);a.$menu.css(b)}},positionSubmenu:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"left top",
at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var c={top:0,left:this.outerWidth()};b.css(c)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop},callback:null,items:{}},s={timer:null,pageX:null,pageY:null},o=function(a){for(var b=0;;)if(b=Math.max(b,parseInt(a.css("z-index"),10)||0),a=a.parent(),!a||!a.length||"html body".indexOf(a.prop("nodeName").toLowerCase())>-1)break;return b},n={abortevent:function(a){a.preventDefault();
a.stopImmediatePropagation()},contextmenu:function(b){var c=a(this);b.preventDefault();b.stopImmediatePropagation();if(!(b.data.trigger!="right"&&b.originalEvent)&&!c.hasClass("context-menu-active")&&!c.hasClass("context-menu-disabled")){d=c;if(b.data.build){var e=b.data.build(d,b);if(e===!1)return;b.data=a.extend(!0,{},y,b.data,e||{});if(!b.data.items||a.isEmptyObject(b.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),Error("No Items specified");
b.data.$trigger=d;u.create(b.data)}u.show.call(c,b.data,b.pageX,b.pageY)}},click:function(b){b.preventDefault();b.stopImmediatePropagation();a(this).trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))},mousedown:function(b){var c=a(this);d&&d.length&&!d.is(c)&&d.data("contextMenu").$menu.trigger("contextmenu:hide");b.button==2&&(d=c.data("contextMenuActive",!0))},mouseup:function(b){var c=a(this);c.data("contextMenuActive")&&d&&d.length&&d.is(c)&&!c.hasClass("context-menu-disabled")&&
(b.preventDefault(),b.stopImmediatePropagation(),d=c,c.trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY})));c.removeData("contextMenuActive")},mouseenter:function(b){var c=a(this),e=a(b.relatedTarget),v=a(document);if(!e.is(".context-menu-list")&&!e.closest(".context-menu-list").length&&(!d||!d.length))s.pageX=b.pageX,s.pageY=b.pageY,s.data=b.data,v.on("mousemove.contextMenuShow",n.mousemove),s.timer=setTimeout(function(){s.timer=null;v.off("mousemove.contextMenuShow");d=c;c.trigger(a.Event("contextmenu",
{data:s.data,pageX:s.pageX,pageY:s.pageY}))},b.data.delay)},mousemove:function(a){s.pageX=a.pageX;s.pageY=a.pageY},mouseleave:function(b){b=a(b.relatedTarget);if(!b.is(".context-menu-list")&&!b.closest(".context-menu-list").length){try{clearTimeout(s.timer)}catch(c){}s.timer=null}},layerClick:function(b){var c=a(this).data("contextMenuRoot"),d=b.button,e=b.pageX,f=b.pageY,o,g;b.preventDefault();b.stopImmediatePropagation();setTimeout(function(){var n,u=c.trigger=="left"&&d===0||c.trigger=="right"&&
d===2;document.elementFromPoint&&(c.$layer.hide(),o=document.elementFromPoint(e-h.scrollLeft(),f-h.scrollTop()),c.$layer.show());if(c.reposition&&u)if(document.elementFromPoint){if(c.$trigger.is(o)||c.$trigger.has(o).length){c.position.call(c.$trigger,c,e,f);return}}else if(g=c.$trigger.offset(),n=a(window),g.top+=n.scrollTop(),g.top<=b.pageY&&(g.left+=n.scrollLeft(),g.left<=b.pageX&&(g.bottom=g.top+c.$trigger.outerHeight(),g.bottom>=b.pageY&&(g.right=g.left+c.$trigger.outerWidth(),g.right>=b.pageX)))){c.position.call(c.$trigger,
c,e,f);return}if(o&&u)c.$trigger.one("contextmenu:hidden",function(){a(o).contextMenu({x:e,y:f})});c.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var b=d.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(n.keyStop(a,b),b.isInput)if(a.keyCode==9&&a.shiftKey){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("prevcommand");return}else{if(a.keyCode==38&&b.$selected.find("input, textarea, select").prop("type")==
"checkbox"){a.preventDefault();return}}else if(a.keyCode!=9||a.shiftKey){b.$menu.trigger("prevcommand");return}case 40:n.keyStop(a,b);if(b.isInput)if(a.keyCode==9){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("nextcommand");return}else{if(a.keyCode==40&&b.$selected.find("input, textarea, select").prop("type")=="checkbox"){a.preventDefault();return}}else{b.$menu.trigger("nextcommand");return}break;case 37:n.keyStop(a,b);if(b.isInput||!b.$selected||
!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){a=b.$selected.parent().parent();b.$selected.trigger("contextmenu:blur");b.$selected=a;return}break;case 39:n.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;var c=b.$selected.data("contextMenu")||{};if(c.$menu&&b.$selected.hasClass("context-menu-submenu")){b.$selected=null;c.$selected=null;c.$menu.trigger("nextcommand");return}break;case 35:case 36:if(!b.$selected||!b.$selected.find("input, textarea, select").length)(b.$selected&&
b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[a.keyCode==36?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault();return;case 13:n.keyStop(a,b);if(b.isInput){if(b.$selected&&!b.$selected.is("textarea, select")){a.preventDefault();return}break}b.$selected&&b.$selected.trigger("mouseup");return;case 32:case 33:case 34:n.keyStop(a,b);return;case 27:n.keyStop(a,b);b.$menu.trigger("contextmenu:hide");return;default:if(c=String.fromCharCode(a.keyCode).toUpperCase(),
b.accesskeys[c]){b.accesskeys[c].$node.trigger(b.accesskeys[c].$menu?"contextmenu:focus":"mouseup");return}}a.stopPropagation();b.$selected&&b.$selected.trigger(a)},prevItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected,c=c.$selected.parent().data("contextMenu")||{};c.$selected=d}for(var d=c.$menu.children(),e=!c.$selected||!c.$selected.prev().length?d.last():c.$selected.prev(),f=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=
e.prev().length?e.prev():d.last(),e.is(f))return;c.$selected&&n.itemMouseleave.call(c.$selected.get(0),b);n.itemMouseenter.call(e.get(0),b);b=e.find("input, textarea, select");b.length&&b.focus()},nextItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected,c=c.$selected.parent().data("contextMenu")||{};c.$selected=d}for(var d=c.$menu.children(),e=!c.$selected||!c.$selected.next().length?d.first():c.$selected.next(),f=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=
e.next().length?e.next():d.first(),e.is(f))return;c.$selected&&n.itemMouseleave.call(c.$selected.get(0),b);n.itemMouseenter.call(e.get(0),b);b=e.find("input, textarea, select");b.length&&b.focus()},focusInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,c=c.contextMenuRoot;c.$selected=d.$selected=b;c.isInput=d.isInput=!0},blurInput:function(){var b=a(this).closest(".context-menu-item").data();b.contextMenuRoot.isInput=b.contextMenu.isInput=!1},menuMouseenter:function(){a(this).data().contextMenuRoot.hovering=
!0},menuMouseleave:function(b){var c=a(this).data().contextMenuRoot;if(c.$layer&&c.$layer.is(b.relatedTarget))c.hovering=!1},itemMouseenter:function(b){var c=a(this),d=c.data(),e=d.contextMenu,d=d.contextMenuRoot;d.hovering=!0;b&&d.$layer&&d.$layer.is(b.relatedTarget)&&(b.preventDefault(),b.stopImmediatePropagation());(e.$menu?e:d).$menu.children(".hover").trigger("contextmenu:blur");c.hasClass("disabled")||c.hasClass("not-selectable")?e.$selected=null:c.trigger("contextmenu:focus")},itemMouseleave:function(b){var c=
a(this),d=c.data(),e=d.contextMenu,d=d.contextMenuRoot;d!==e&&d.$layer&&d.$layer.is(b.relatedTarget)?(d.$selected&&d.$selected.trigger("contextmenu:blur"),b.preventDefault(),b.stopImmediatePropagation(),d.$selected=e.$selected=e.$node):c.trigger("contextmenu:blur")},itemClick:function(b){var c=a(this),d=c.data(),e=d.contextMenuRoot,f=d.contextMenuKey;if(d.contextMenu.items[f]&&!c.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){b.preventDefault();b.stopImmediatePropagation();
if(a.isFunction(e.callbacks[f])&&Object.prototype.hasOwnProperty.call(e.callbacks,f))b=e.callbacks[f];else if(a.isFunction(e.callback))b=e.callback;else return;b.call(e.$trigger,f,e)!==!1?e.$menu.trigger("contextmenu:hide"):e.$menu.parent().length&&u.update.call(e.$trigger,e)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(b,c){var d=a(this).data("contextMenuRoot");u.hide.call(d.$trigger,d,c&&c.force)},focusItem:function(b){b.stopPropagation();var b=a(this),c=b.data(),d=c.contextMenu,
c=c.contextMenuRoot;b.addClass("hover").siblings(".hover").trigger("contextmenu:blur");d.$selected=c.$selected=b;d.$node&&c.positionSubmenu.call(d.$node,d.$menu)},blurItem:function(b){b.stopPropagation();var b=a(this),c=b.data().contextMenu;b.removeClass("hover");c.$selected=null}},u={show:function(b,c,e){var f=a(this),g={};a("#context-menu-layer").trigger("mousedown");b.$trigger=f;if(b.events.show.call(f,b)===!1)d=null;else{u.update.call(f,b);b.position.call(f,b,c,e);if(b.zIndex)g.zIndex=o(f)+b.zIndex;
u.layer.call(b.$menu,b,g.zIndex);b.$menu.find("ul").css("zIndex",g.zIndex+1);b.$menu.css(g)[b.animation.show](b.animation.duration,function(){f.trigger("contextmenu:visible")});f.data("contextMenu",b).addClass("context-menu-active");a(document).off("keydown.contextMenu").on("keydown.contextMenu",n.key);if(b.autoHide)a(document).on("mousemove.contextMenuAutoHide",function(a){var c=f.offset();c.right=c.left+f.outerWidth();c.bottom=c.top+f.outerHeight();b.$layer&&!b.hovering&&(!(a.pageX>=c.left&&a.pageX<=
c.right)||!(a.pageY>=c.top&&a.pageY<=c.bottom))&&b.$menu.trigger("contextmenu:hide")})}},hide:function(c,e){var f=a(this);c||(c=f.data("contextMenu")||{});if(e||!(c.events&&c.events.hide.call(f,c)===!1)){f.removeData("contextMenu").removeClass("context-menu-active");if(c.$layer){setTimeout(function(a){return function(){a.remove()}}(c.$layer),10);try{delete c.$layer}catch(g){c.$layer=null}}d=null;c.$menu.find(".hover").trigger("contextmenu:blur");c.$selected=null;a(document).off(".contextMenuAutoHide").off("keydown.contextMenu");
c.$menu&&c.$menu[c.animation.hide](c.animation.duration,function(){c.build&&(c.$menu.remove(),a.each(c,function(a){switch(a){case "ns":case "selector":case "build":case "trigger":return!0;default:c[a]=b;try{delete c[a]}catch(d){}return!0}}));setTimeout(function(){f.trigger("contextmenu:hidden")},10)})}},create:function(d,e){e===b&&(e=d);d.$menu=a('<ul class="context-menu-list"></ul>').addClass(d.className||"").data({contextMenu:d,contextMenuRoot:e});a.each(["callbacks","commands","inputs"],function(a,
b){d[b]={};e[b]||(e[b]={})});e.accesskeys||(e.accesskeys={});a.each(d.items,function(b,f){var g=a('<li class="context-menu-item"></li>').addClass(f.className||""),o=null,h=null;g.on("click",a.noop);f.$node=g.data({contextMenu:d,contextMenuRoot:e,contextMenuKey:b});if(f.accesskey)for(var j=c(f.accesskey),k=0,l;l=j[k];k++)if(!e.accesskeys[l]){e.accesskeys[l]=f;f._name=f.name.replace(RegExp("("+l+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if(typeof f=="string")g.addClass("context-menu-separator not-selectable");
else if(f.type&&x[f.type])x[f.type].call(g,f,d,e),a.each([d,e],function(c,d){d.commands[b]=f;if(a.isFunction(f.callback))d.callbacks[b]=f.callback});else{if(f.type=="html")g.addClass("context-menu-html not-selectable");else if(f.type)o=a("<label></label>").appendTo(g),a("<span></span>").html(f._name||f.name).appendTo(o),g.addClass("context-menu-input"),d.hasTypes=!0,a.each([d,e],function(a,c){c.commands[b]=f;c.inputs[b]=f});else if(f.items)f.type="sub";switch(f.type){case "text":h=a('<input type="text" value="1" name="" value="">').attr("name",
"context-menu-input-"+b).val(f.value||"").appendTo(o);break;case "textarea":h=a('<textarea name=""></textarea>').attr("name","context-menu-input-"+b).val(f.value||"").appendTo(o);f.height&&h.height(f.height);break;case "checkbox":h=a('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(f.value||"").prop("checked",!!f.selected).prependTo(o);break;case "radio":h=a('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+f.radio).val(f.value||
"").prop("checked",!!f.selected).prependTo(o);break;case "select":h=a('<select name="">').attr("name","context-menu-input-"+b).appendTo(o);f.options&&(a.each(f.options,function(b,c){a("<option></option>").val(b).text(c).appendTo(h)}),h.val(f.selected));break;case "sub":a("<span></span>").html(f._name||f.name).appendTo(g);f.appendTo=f.$node;u.create(f,e);g.data("contextMenu",f).addClass("context-menu-submenu");f.callback=null;break;case "html":a(f.html).appendTo(g);break;default:a.each([d,e],function(c,
d){d.commands[b]=f;if(a.isFunction(f.callback))d.callbacks[b]=f.callback}),a("<span></span>").html(f._name||f.name||"").appendTo(g)}if(f.type&&f.type!="sub"&&f.type!="html"&&(h.on("focus",n.focusInput).on("blur",n.blurInput),f.events))h.on(f.events,d);f.icon&&g.addClass("icon icon-"+f.icon)}f.$input=h;f.$label=o;g.appendTo(d.$menu);if(!d.hasTypes&&a.support.eventSelectstart)g.on("selectstart.disableTextSelect",n.abortevent)});d.$node||d.$menu.css("display","none").addClass("context-menu-root");d.$menu.appendTo(d.appendTo||
document.body)},resize:function(b,c){b.css({position:"absolute",display:"block"});b.data("width",Math.ceil(b.width())+1);b.css({position:"static",minWidth:"0px",maxWidth:"100000px"});b.find("> li > ul").each(function(){u.resize(a(this),!0)});c||b.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return a(this).data("width")})},update:function(c,d){var e=this;d===b&&(d=c,u.resize(c.$menu));c.$menu.children().each(function(){var b=a(this),f=b.data("contextMenuKey"),
g=c.items[f],f=a.isFunction(g.disabled)&&g.disabled.call(e,f,d)||g.disabled===!0;b[f?"addClass":"removeClass"]("disabled");if(g.type)switch(b.find("input, select, textarea").prop("disabled",f),g.type){case "text":case "textarea":g.$input.val(g.value||"");break;case "checkbox":case "radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case "select":g.$input.val(g.selected||"")}g.$menu&&u.update.call(e,g,d)})},layer:function(b,c){var d=b.$layer=a('<div id="context-menu-layer" style="position:fixed; z-index:'+
c+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:h.height(),width:h.width(),display:"block"}).data("contextMenuRoot",b).insertBefore(this).on("contextmenu",n.abortevent).on("mousedown",n.layerClick);a.support.fixedPosition||d.css({position:"absolute",height:a(document).height()});return d}};a.fn.contextMenu=function(c){c===b?this.first().trigger("contextmenu"):c.x&&c.y?this.first().trigger(a.Event("contextmenu",{pageX:c.x,pageY:c.y})):c==="hide"?
(c=this.data("contextMenu").$menu)&&c.trigger("contextmenu:hide"):c==="destroy"?a.contextMenu("destroy",{context:this}):a.isPlainObject(c)?(c.context=this,a.contextMenu("create",c)):c?this.removeClass("context-menu-disabled"):c||this.addClass("context-menu-disabled");return this};a.contextMenu=function(c,d){typeof c!="string"&&(d=c,c="create");typeof d=="string"?d={selector:d}:d===b&&(d={});var e=a.extend(!0,{},y,d||{}),f=a(document),o=f,h=!1;!e.context||!e.context.length?e.context=document:(o=a(e.context).first(),
e.context=o.get(0),h=e.context!==document);switch(c){case "create":if(!e.selector)throw Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||a.isEmptyObject(e.items)))throw Error("No Items specified");k++;e.ns=".contextMenu"+k;if(!h)l[e.selector]=e.ns;r[e.ns]=e;if(!e.trigger)e.trigger="right";g||(f.on({"contextmenu:hide.contextMenu":n.hideMenu,
"prevcommand.contextMenu":n.prevItem,"nextcommand.contextMenu":n.nextItem,"contextmenu.contextMenu":n.abortevent,"mouseenter.contextMenu":n.menuMouseenter,"mouseleave.contextMenu":n.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",n.inputClick).on({"mouseup.contextMenu":n.itemClick,"contextmenu:focus.contextMenu":n.focusItem,"contextmenu:blur.contextMenu":n.blurItem,"contextmenu.contextMenu":n.abortevent,"mouseenter.contextMenu":n.itemMouseenter,"mouseleave.contextMenu":n.itemMouseleave},
".context-menu-item"),g=!0);o.on("contextmenu"+e.ns,e.selector,e,n.contextmenu);if(h)o.on("remove"+e.ns,function(){a(this).contextMenu("destroy")});switch(e.trigger){case "hover":o.on("mouseenter"+e.ns,e.selector,e,n.mouseenter).on("mouseleave"+e.ns,e.selector,e,n.mouseleave);break;case "left":o.on("click"+e.ns,e.selector,e,n.click)}e.build||u.create(e);break;case "destroy":var j;if(h){var q=e.context;a.each(r,function(b,c){if(c.context!==q)return!0;j=a(".context-menu-list").filter(":visible");j.length&&
j.data().contextMenuRoot.$trigger.is(a(c.context).find(c.selector))&&j.trigger("contextmenu:hide",{force:!0});try{r[c.ns].$menu&&r[c.ns].$menu.remove(),delete r[c.ns]}catch(d){r[c.ns]=null}a(c.context).off(c.ns);return!0})}else if(e.selector){if(l[e.selector]){j=a(".context-menu-list").filter(":visible");j.length&&j.data().contextMenuRoot.$trigger.is(e.selector)&&j.trigger("contextmenu:hide",{force:!0});try{r[l[e.selector]].$menu&&r[l[e.selector]].$menu.remove(),delete r[l[e.selector]]}catch(p){r[l[e.selector]]=
null}f.off(l[e.selector])}}else f.off(".contextMenu .contextMenuAutoHide"),a.each(r,function(b,c){a(c.context).off(c.ns)}),l={},r={},k=0,g=!1,a("#context-menu-layer, .context-menu-list").remove();break;case "html5":(!a.support.htmlCommand&&!a.support.htmlMenuitem||typeof d=="boolean"&&d)&&a('menu[type="context"]').each(function(){this.id&&a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+
c+'"');}return this};a.contextMenu.setInputValues=function(c,d){d===b&&(d={});a.each(c.inputs,function(a,b){switch(b.type){case "text":case "textarea":b.value=d[a]||"";break;case "checkbox":b.selected=d[a]?!0:!1;break;case "radio":b.selected=(d[b.radio]||"")==b.value?!0:!1;break;case "select":b.selected=d[a]||""}})};a.contextMenu.getInputValues=function(c,d){d===b&&(d={});a.each(c.inputs,function(a,b){switch(b.type){case "text":case "textarea":case "select":d[a]=b.$input.val();break;case "checkbox":d[a]=
b.$input.prop("checked");break;case "radio":if(b.$input.prop("checked"))d[b.radio]=b.value}});return d};a.contextMenu.fromMenu=function(b){var b=a(b),c={};f(c,b.children());return c};a.contextMenu.defaults=y;a.contextMenu.types=x;a.contextMenu.handle=n;a.contextMenu.op=u;a.contextMenu.menus=r})(jQuery);(function(a,b){function c(a,b,c){return[parseInt(a[0],10)*(y.test(a[0])?b/100:1),parseInt(a[1],10)*(y.test(a[1])?c/100:1)]}function e(b,c){return parseInt(a.css(b,c),10)||0}function f(b){var c=b[0];return c.nodeType===9?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}
a.ui=a.ui||{};var j,d=Math.max,g=Math.abs,h=Math.round,k=/left|center|right/,l=/top|center|bottom/,r=/[\+\-]\d+%?/,x=/^\w+/,y=/%$/,s=a.fn.position;a.position={scrollbarWidth:function(){if(j!==b)return j;var c,d,e=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");d=e.children()[0];a("body").append(e);c=d.offsetWidth;e.css("overflow","scroll");d=d.offsetWidth;if(c===d)d=e[0].clientWidth;e.remove();return j=c-d},getScrollInfo:function(b){var c=
b.isWindow?"":b.element.css("overflow-x"),d=b.isWindow?"":b.element.css("overflow-y"),d=d==="scroll"||d==="auto"&&b.height<b.element[0].scrollHeight;return{width:c==="scroll"||c==="auto"&&b.width<b.element[0].scrollWidth?a.position.scrollbarWidth():0,height:d?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var b=a(b||window),c=a.isWindow(b[0]);return{element:b,isWindow:c,offset:b.offset()||{left:0,top:0},scrollLeft:b.scrollLeft(),scrollTop:b.scrollTop(),width:c?b.width():b.outerWidth(),
height:c?b.height():b.outerHeight()}}};a.fn.position=function(b){if(!b||!b.of)return s.apply(this,arguments);var b=a.extend({},b),n,j,z,w,t,v,B=a(b.of),C=a.position.getWithinInfo(b.within),D=a.position.getScrollInfo(C),q=(b.collision||"flip").split(" "),p={};v=f(B);if(B[0].preventDefault)b.at="left top";j=v.width;z=v.height;w=v.offset;t=a.extend({},w);a.each(["my","at"],function(){var a=(b[this]||"").split(" "),c,d;a.length===1&&(a=k.test(a[0])?a.concat(["center"]):l.test(a[0])?["center"].concat(a):
["center","center"]);a[0]=k.test(a[0])?a[0]:"center";a[1]=l.test(a[1])?a[1]:"center";c=r.exec(a[0]);d=r.exec(a[1]);p[this]=[c?c[0]:0,d?d[0]:0];b[this]=[x.exec(a[0])[0],x.exec(a[1])[0]]});q.length===1&&(q[1]=q[0]);b.at[0]==="right"?t.left+=j:b.at[0]==="center"&&(t.left+=j/2);b.at[1]==="bottom"?t.top+=z:b.at[1]==="center"&&(t.top+=z/2);n=c(p.at,j,z);t.left+=n[0];t.top+=n[1];return this.each(function(){var f,k,l=a(this),v=l.outerWidth(),r=l.outerHeight(),s=e(this,"marginLeft"),x=e(this,"marginTop"),
y=v+s+e(this,"marginRight")+D.width,G=r+x+e(this,"marginBottom")+D.height,A=a.extend({},t),F=c(p.my,l.outerWidth(),l.outerHeight());b.my[0]==="right"?A.left-=v:b.my[0]==="center"&&(A.left-=v/2);b.my[1]==="bottom"?A.top-=r:b.my[1]==="center"&&(A.top-=r/2);A.left+=F[0];A.top+=F[1];if(!a.support.offsetFractions)A.left=h(A.left),A.top=h(A.top);f={marginLeft:s,marginTop:x};a.each(["left","top"],function(c,d){if(a.ui.position[q[c]])a.ui.position[q[c]][d](A,{targetWidth:j,targetHeight:z,elemWidth:v,elemHeight:r,
collisionPosition:f,collisionWidth:y,collisionHeight:G,offset:[n[0]+F[0],n[1]+F[1]],my:b.my,at:b.at,within:C,elem:l})});b.using&&(k=function(a){var c=w.left-A.left,e=c+j-v,f=w.top-A.top,h=f+z-r,n={target:{element:B,left:w.left,top:w.top,width:j,height:z},element:{element:l,left:A.left,top:A.top,width:v,height:r},horizontal:e<0?"left":c>0?"right":"center",vertical:h<0?"top":f>0?"bottom":"middle"};if(j<v&&g(c+e)<j)n.horizontal="center";if(z<r&&g(f+h)<z)n.vertical="middle";n.important=d(g(c),g(e))>d(g(f),
g(h))?"horizontal":"vertical";b.using.call(this,a,n)});l.offset(a.extend(A,{using:k}))})};a.ui.position={fit:{left:function(a,b){var c=b.within,e=c.isWindow?c.scrollLeft:c.offset.left,f=c.width,g=a.left-b.collisionPosition.marginLeft,c=e-g,h=g+b.collisionWidth-f-e;b.collisionWidth>f?c>0&&h<=0?(e=a.left+c+b.collisionWidth-f-e,a.left+=c-e):a.left=h>0&&c<=0?e:c>h?e+f-b.collisionWidth:e:c>0?a.left+=c:h>0?a.left-=h:a.left=d(a.left-g,a.left)},top:function(a,b){var c=b.within,e=c.isWindow?c.scrollTop:c.offset.top,
f=b.within.height,g=a.top-b.collisionPosition.marginTop,c=e-g,h=g+b.collisionHeight-f-e;b.collisionHeight>f?c>0&&h<=0?(e=a.top+c+b.collisionHeight-f-e,a.top+=c-e):a.top=h>0&&c<=0?e:c>h?e+f-b.collisionHeight:e:c>0?a.top+=c:h>0?a.top-=h:a.top=d(a.top-g,a.top)}},flip:{left:function(a,b){var c=b.within,d=c.offset.left+c.scrollLeft,e=c.width,f=c.isWindow?c.scrollLeft:c.offset.left,h=a.left-b.collisionPosition.marginLeft,c=h-f,j=h+b.collisionWidth-e-f,h=b.my[0]==="left"?-b.elemWidth:b.my[0]==="right"?b.elemWidth:
0,k=b.at[0]==="left"?b.targetWidth:b.at[0]==="right"?-b.targetWidth:0,l=-2*b.offset[0];if(c<0){if(d=a.left+h+k+l+b.collisionWidth-e-d,d<0||d<g(c))a.left+=h+k+l}else if(j>0&&(d=a.left-b.collisionPosition.marginLeft+h+k+l-f,d>0||g(d)<j))a.left+=h+k+l},top:function(a,b){var c=b.within,d=c.offset.top+c.scrollTop,e=c.height,f=c.isWindow?c.scrollTop:c.offset.top,h=a.top-b.collisionPosition.marginTop,c=h-f,j=h+b.collisionHeight-e-f,h=b.my[1]==="top"?-b.elemHeight:b.my[1]==="bottom"?b.elemHeight:0,k=b.at[1]===
"top"?b.targetHeight:b.at[1]==="bottom"?-b.targetHeight:0,l=-2*b.offset[1];if(c<0){if(d=a.top+h+k+l+b.collisionHeight-e-d,a.top+h+k+l>c&&(d<0||d<g(c)))a.top+=h+k+l}else if(j>0&&(d=a.top-b.collisionPosition.marginTop+h+k+l-f,a.top+h+k+l>j&&(d>0||g(d)<j)))a.top+=h+k+l}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments);a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments);a.ui.position.fit.top.apply(this,arguments)}}};(function(){var b,
c,d,e,f=document.getElementsByTagName("body")[0];d=document.createElement("div");b=document.createElement(f?"div":"body");c={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};f&&a.extend(c,{position:"absolute",left:"-1000px",top:"-1000px"});for(e in c)b.style[e]=c[e];b.appendChild(d);c=f||document.documentElement;c.insertBefore(b,c.firstChild);d.style.cssText="position: absolute; left: 10.7432222px;";d=a(d).offset().left;a.support.offsetFractions=d>10&&d<11;b.innerHTML="";
c.removeChild(b)})()})(jQuery);function open_rename_window(a,b,c){if(!(a==""||b=="")){var e=$("div#modalWindow");g_modal_url="/smb/css/rename.html?o="+a+"&f="+b+"&d="+c;g_modal_window_width=500;g_modal_window_height=80;$("#jqmMsg").css("display","none");$("#jqmTitleText").text(m.getString("title_rename"));e&&e.jqmShow()}}
function open_upload2service_window(a,b){var c="";if(b instanceof Array)for(var e=b.length,f=0;f<e;f++)c+=b[f],f!=e-1&&(c+=";");else c=b;c!=""&&(e=$("div#modalWindow"),f="",a=="facebook"?(g_modal_url="/smb/css/service/facebook.html",f=m.getString("title_upload2")+" "+m.getString("title_facebook")):a=="flickr"&&(g_modal_url="/smb/css/service/flickr.html",f=m.getString("title_upload2")+" "+m.getString("title_flickr")),g_modal_url+="?v="+c,g_modal_window_width=600,g_modal_window_height=370,$("#jqmMsg").css("display",
"none"),$("#jqmTitleText").text(f),e.jqmShow())}
function open_sharelink_window(a,b,c){var e="";if(c instanceof Array)for(var f=c.length,j=0;j<f;j++)e+=c[j],j!=f-1&&(e+=";");else e=c;b==""||e==""||(c="",c=a=="facebook"?m.getString("title_share2")+" "+m.getString("title_facebook"):a=="googleplus"?m.getString("title_share2")+" "+m.getString("title_googleplus"):a=="twitter"?m.getString("title_share2")+" "+m.getString("title_twitter"):a=="plurk"?m.getString("title_share2")+" "+m.getString("title_plurk"):m.getString("title_gen_sharelink"),f=$("div#modalWindow"),
g_modal_url="/smb/css/sharelink.html?s="+a+"&u="+b+"&f="+e,g_modal_window_width=600,g_modal_window_height=530,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(c),f&&f.jqmShow())}function download_file(a){a!=""&&$.fileDownload(a,{successCallback:function(){},failCallback:function(a,c){window.open(c)}})}
function download_folder(a){var b="";if(a instanceof Array)for(var c=a.length,e=0;e<c;e++)b+=a[e],e!=c-1&&(b+=";");else b=a;b!=""&&(a=$("div#modalWindow"),g_modal_url="/smb/css/download_folder.html?v="+b+"&u="+g_storage.get("openurl"),g_modal_window_width=600,g_modal_window_height=150,$("#jqmMsg").css("display","none"),$("#jqmTitleText").text(m.getString("title_download_folder")),a&&a.jqmShow())}
function open_uploadfile_window(){if(isBrowser("msie")&&getInternetExplorerVersion()<=9){var a=$("div#modalWindow");g_modal_url="/smb/css/upload_file.html";g_modal_window_width=600;g_modal_window_height=150;$("#jqmMsg").css("display","none");$("#jqmTitleText").text(m.getString("title_upload_file"));a.jqmShow()}else openUploadPanel(1)}
function open_uploadfolder_window(){if(isBrowser("chrome"))openUploadPanel(2);else{var a=$("div#modalWindow");g_modal_url="/smb/css/upload_folder.html";g_modal_window_width=600;g_modal_window_height=150;$("#jqmMsg").css("display","none");$("#jqmTitleText").text(m.getString("title_upload_folder"));a.jqmShow()}};
